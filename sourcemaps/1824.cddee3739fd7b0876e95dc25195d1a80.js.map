{"version":3,"file":"js/1824.1658366122715.97e434624fd82198b6f7.js","mappings":"4QA0BMA,EAAoB,WAMf,6DAAP,GAAO,IALTC,kBAAAA,OAKS,MALWC,EAAAA,GAAAA,KAAAA,kBAKX,MAJTC,YAAaC,OAIJ,MAJuBC,EAAAA,GAAAA,WAAAA,YAIvB,MAHTC,WAAYC,OAGH,MAHqBD,EAAAA,WAGrB,MAFTE,gBAAiBC,OAER,MAF+BD,EAAAA,gBAE/B,MADTE,qBAAsBC,OACb,MADyCN,EAAAA,GAAAA,WAAAA,qBACzC,EACT,EAAsBE,IAAdK,EAAR,EAAQA,UACFC,EAAQJ,IACRK,EAAWV,IACjB,EAA4CO,EAA0B,CACpEI,GAAI,WACJC,SAAU,kBAAGC,EAAH,EAAGA,SAAH,OAAkBA,MAAAA,GAAlB,UAAkBA,EAAUC,cAA5B,aAAkB,EAAmBN,MAFzCO,EAAR,EAAQA,MAAOC,EAAf,EAAeA,UAAWC,EAA1B,EAA0BA,QAASC,EAAnC,EAAmCA,MAKnCC,EAAAA,EAAAA,IAAwB,WACtB,GAAIX,EAAW,OACb,EAA+BY,EAAAA,GAAAA,kBAA8B,WAArDC,EAAR,EAAQA,UAAWC,EAAnB,EAAmBA,QACbC,GAAe,kBAChBd,GADa,mBAEfe,EAAAA,GAAAA,YAAuCC,EAAAA,GAAAA,QAFxB,SAGfD,EAAAA,GAAAA,WAAsCH,EAAUK,gBAHjC,SAIfF,EAAAA,GAAAA,SAAoCF,EAAQI,eAJ7B,IAOlB7B,EAAkBW,EAAWe,EAA7B1B,CAA2Ca,MAE5C,CAACF,EAAWC,IAEf,IAAMkB,EAAc,CAClBC,qBAAqB,GAGvB,GAAIZ,EAAW,SACb,EAA0BE,GAAQ,GAAlC,IAAQL,SAAAA,OAAR,MAAmB,GAAnB,EAEAc,EAAYC,yBAMFC,KALRhB,MAAAA,GAAA,UAAAA,EAAUK,YAAV,mBACIY,iBADJ,eAEIC,MACA,mBACe,IADf,EAAIC,EAAAA,GAAAA,mCAAAA,8BAKZ,MAAO,CACLjB,MAAAA,EACAC,UAAAA,EACAC,QAAAA,EACAC,MAAM,UACDS,KAKHM,EAAU,CACdrC,kBAAAA","sources":["webpack:///./src/components/bannerMessages/bannerMessagesContext.js"],"sourcesContent":["import { useShallowCompareEffect } from 'react-use';\nimport { reduxActions, storeHooks } from '../../redux';\nimport { useProduct, useProductQuery } from '../productView/productViewContext';\nimport { dateHelpers } from '../../common';\nimport {\n  rhsmConstants,\n  RHSM_API_QUERY_GRANULARITY_TYPES as GRANULARITY_TYPES,\n  RHSM_API_QUERY_SET_TYPES\n} from '../../services/rhsm/rhsmConstants';\n\n/**\n * ToDo: useGetAppMessages is setup to work with existing Tally response, pre-metrics\n * Banner messages scans the returned Tally listing for the HAS_CLOUDIGRADE_MISMATCH. In the future\n * this may need to be updated to pull from the \"meta\" object part of the Tally response.\n */\n/**\n * Get app messages.\n *\n * @param {object} options\n * @param {Function} options.getMessageReports\n * @param {Function} options.useDispatch\n * @param {Function} options.useProduct\n * @param {Function} options.useProductQuery\n * @param {Function} options.useSelectorsResponse\n * @returns {object}\n */\nconst useGetAppMessages = ({\n  getMessageReports = reduxActions.rhsm.getMessageReports,\n  useDispatch: useAliasDispatch = storeHooks.reactRedux.useDispatch,\n  useProduct: useAliasProduct = useProduct,\n  useProductQuery: useAliasProductQuery = useProductQuery,\n  useSelectorsResponse: useAliasSelectorsResponse = storeHooks.reactRedux.useSelectorsResponse\n} = {}) => {\n  const { productId } = useAliasProduct();\n  const query = useAliasProductQuery();\n  const dispatch = useAliasDispatch();\n  const { error, fulfilled, pending, data } = useAliasSelectorsResponse({\n    id: 'messages',\n    selector: ({ messages }) => messages?.report?.[productId]\n  });\n\n  useShallowCompareEffect(() => {\n    if (productId) {\n      const { startDate, endDate } = dateHelpers.getRangedDateTime('CURRENT');\n      const updatedQuery = {\n        ...query,\n        [RHSM_API_QUERY_SET_TYPES.GRANULARITY]: GRANULARITY_TYPES.DAILY,\n        [RHSM_API_QUERY_SET_TYPES.START_DATE]: startDate.toISOString(),\n        [RHSM_API_QUERY_SET_TYPES.END_DATE]: endDate.toISOString()\n      };\n\n      getMessageReports(productId, updatedQuery)(dispatch);\n    }\n  }, [productId, query]);\n\n  const updatedData = {\n    cloudigradeMismatch: false\n  };\n\n  if (fulfilled) {\n    const { messages = {} } = data || {};\n\n    updatedData.cloudigradeMismatch =\n      messages?.data\n        ?.reverse()\n        ?.find(\n          ({ [rhsmConstants.RHSM_API_RESPONSE_TALLY_META_TYPES.HAS_CLOUDIGRADE_MISMATCH]: mismatch }) =>\n            mismatch === true\n        ) !== undefined;\n  }\n\n  return {\n    error,\n    fulfilled,\n    pending,\n    data: {\n      ...updatedData\n    }\n  };\n};\n\nconst context = {\n  useGetAppMessages\n};\n\nexport { context as default, context, useGetAppMessages };\n"],"names":["useGetAppMessages","getMessageReports","reduxActions","useDispatch","useAliasDispatch","storeHooks","useProduct","useAliasProduct","useProductQuery","useAliasProductQuery","useSelectorsResponse","useAliasSelectorsResponse","productId","query","dispatch","id","selector","messages","report","error","fulfilled","pending","data","useShallowCompareEffect","dateHelpers","startDate","endDate","updatedQuery","RHSM_API_QUERY_SET_TYPES","GRANULARITY_TYPES","toISOString","updatedData","cloudigradeMismatch","undefined","reverse","find","rhsmConstants","context"],"sourceRoot":""}