(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1452:function(e,t,a){},1453:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"default",function(){return T}),a.d(n,"GET_GRAPH_REPORT",function(){return T});var r={};a.r(r),a.d(r,"USER_AUTH",function(){return S}),a.d(r,"USER_LOCALE",function(){return I}),a.d(r,"USER_LOGOUT",function(){return L});var o={};a.r(o),a.d(o,"default",function(){return le}),a.d(o,"getGraphReports",function(){return le});var i={};a.r(i),a.d(i,"authorizeUser",function(){return he}),a.d(i,"getLocale",function(){return fe});var l=a(2),c=a.n(l),s=a(40),u=a(136),d=a(195),p=a(59),E={generateId:function(e){return"".concat(e||"generatedid","-").concat(Math.ceil(1e5*Math.random())||"")},noop:Function.prototype,noopPromise:Promise.resolve({}),noopTranslate:function(e,t){return t||"t('".concat(e,"')")},DEV_MODE:!1,PROD_MODE:!0,REVIEW_MODE:!1,TEST_MODE:!1,UI_DEPLOY_PATH_PREFIX:"/beta",UI_DISABLED:!1,UI_DISPLAY_NAME:"Subscription Reporting",UI_LOGGER_ID:"curiosity",UI_NAME:"subscriptions",UI_PATH:"/beta/apps/subscriptions",UI_VERSION:"0.1.0.b67efb8"};window.curiosity=Object(p.a)({},E);var h=a(7),f=a(8),v=a(10),m=a(6),_=a(9),g=a(47),O=a(382),b=a(124),R=a(271),y=a(88),P=a(137),D=(a(387),a(351)),A=[a(352).a,D.a];var T="GET_GRAPH_REPORT",S="USER_AUTH",I="USER_LOCALE",L="USER_LOGOUT",C="data",U="date",j="sockets",M="granularity",N="beginning",k="ending",w=a(144),G=a.n(w),x=a(604),H=a.n(x),z=a(605),V=a.n(z),F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e,"_FULFILLED")},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e,"_PENDING")},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e,"_REJECTED")},B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=G()(e,"response.status",e.status),n=G()(e,"response.statusText",e.statusText),r=G()(e,"response.data",e.message),o=G()(e,"response.data",e.detail),i="";if(!r&&!o){if(a<400)return n;if(a>=500||void 0===a)return"".concat(a||""," Server is currently unable to handle this request.")}if((a>=500||void 0===a)&&(i=a?"".concat(a," "):""),"string"===typeof r)return"".concat(i).concat(r);if("string"===typeof o)return"".concat(i).concat(o);return"".concat(i).concat(H()(function e(t,a){var n=a?t[a]:t;return V()(n,function(t){return Array.isArray(t)?e(t):t},null)}(r||o,t),"\n"))},X=function(e){var t=G()(e,"response.status",e.status);return void 0===t&&(t=0),t},J=function(e,t,a){var n=a.state,r=void 0===n?{}:n,o=a.initialState,i=void 0===o?{}:o,l=a.reset,c=void 0===l||l,s=Object(p.a)({},r);return c&&e?s[e]=Object(p.a)({},r[e],i[e],t):c&&!e?s=Object(p.a)({},r,i,t):e?s[e]=Object(p.a)({},r[e],t):s=Object(p.a)({},r,t),s},q={graphData:{usage:[]},error:!1,errorStatus:null,errorMessage:null,pending:!1,fulfilled:!1},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y(n.GET_GRAPH_REPORT):return J(null,{error:t.error,errorMessage:B(t.payload),errorStatus:X(t.payload)},{state:e,initialState:q});case W(n.GET_GRAPH_REPORT):return J(null,{pending:!0},{state:e,initialState:q});case F(n.GET_GRAPH_REPORT):return J(null,{graphData:{usage:t.payload.data[C]||[]},fulfilled:!0},{state:e,initialState:q});default:return e}};K.initialState=q;var Q={view:{data:[],error:!1,errorStatus:null,errorMessage:null,pending:!1,fulfilled:!1}},Z=function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q};Z.initialState=Q;var $={session:{error:!1,errorMessage:null,errorStatus:null,pending:!1,fulfilled:!1,authorized:!1,locale:null}},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y(r.USER_AUTH):return J("session",{error:t.error,errorMessage:B(t.payload),errorStatus:X(t.payload),locale:e.session.locale},{state:e,initialState:$});case W(r.USER_AUTH):return J("session",{locale:e.session.locale,pending:!0},{state:e,initialState:$});case F(r.USER_AUTH):return J("session",{authorized:!0,fulfilled:!0,locale:e.session.locale,username:t.username},{state:e,initialState:$});case F(r.USER_LOCALE):return J("session",{locale:t.payload.data},{state:e,reset:!1});default:return e}};ee.initialState=$;var te={rhelGraph:K,rhelView:Z,user:ee},ae=Object(P.c)(te),ne=Object(P.d)(ae,P.a.apply(void 0,Object(y.a)(A))),re=a(606),oe=a.n(re),ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return oe()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({headers:{},timeout:"60000"},e)}({url:"/api/rhsm-subscriptions/v1/tally/products/RHEL",params:e}))},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return t({type:n.GET_GRAPH_REPORT,payload:ie(e)})}},ce=a(607),se=a.n(ce),ue=a(630),de=function(){var e=(se.a.get("rh_locale")||"").replace("_","-"),t=e&&ue.a.getLanguageName(e)||null;return t&&{value:e,key:t}||null},pe=function(){var e=E.noopPromise;try{e=window.insights.chrome.auth.getUser}catch(t){E.TEST_MODE||console.warn("{ getUser } = insights.chrome.auth: ".concat(t.message))}return e},Ee=function(){var e={value:"en-US",key:"English"};return new Promise(function(t){return t({data:de()||e})})},he=function(){return function(e){return e({type:r.USER_AUTH,payload:pe()})}},fe=function(){return{type:r.USER_LOCALE,payload:Ee()}},ve={rhel:o,user:i},me=Object(p.a)({},ve),_e=function(e,t){return function(a){return Object(u.connect)(e,t)(!E.TEST_MODE&&Object(R.b)()(a)||a)}},ge=function(e,t){return function(a){return Object(b.k)(Object(u.connect)(e,t)(a))}},Oe=a(19),be=a(373),Re=a(374),ye=a(377),Pe=a(375),De=a(381),Ae=a(376),Te=a(1465),Se=a(1463),Ie=a(1467),Le=a(1464),Ce=a(1468),Ue=a(105),je=a.n(Ue),Me={defaultDateTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(E.TEST_MODE?"20190720":E.DEV_MODE&&Object({NODE_ENV:"production",PUBLIC_URL:"/beta/apps/subscriptions",REACT_APP_ENV:"production",REACT_APP_UI_VERSION:"0.1.0.b67efb8",REACT_APP_UI_NAME:"subscriptions",REACT_APP_UI_DISPLAY_NAME:"Subscription Reporting",REACT_APP_UI_DEPLOY_PATH_PREFIX:"/beta",REACT_APP_UI_DISABLED:"false",REACT_APP_UI_LOGGER_ID:"curiosity",REACT_APP_AJAX_TIMEOUT:"60000",REACT_APP_CONFIG_SERVICE_LOCALES_COOKIE:"rh_locale",REACT_APP_CONFIG_SERVICE_LOCALES_DEFAULT_LNG:"en-US",REACT_APP_CONFIG_SERVICE_LOCALES_DEFAULT_LNG_DESC:"English",REACT_APP_CONFIG_SERVICE_LOCALES:"/beta/apps/subscriptions/locales/locales.json",REACT_APP_CONFIG_SERVICE_LOCALES_PATH:"/beta/apps/subscriptions/locales/{{lng}}.json",REACT_APP_CONFIG_SERVICE_LOCALES_EXPIRE:"604800000",REACT_APP_INCLUDE_CONTENT_HEADER:'<esi:include src="/beta/apps/chrome/snippets/head.html" />',REACT_APP_INCLUDE_CONTENT_BODY:'<esi:include src="/beta/apps/chrome/snippets/body.html" />',REACT_APP_SERVICES_RHSM_REPORT_RHEL:"/api/rhsm-subscriptions/v1/tally/products/RHEL"}).REACT_APP_DEBUG_DEFAULT_DATETIME)||new Date;return{start:je.a.utc(e).startOf("day").subtract(30,"days").toDate(),end:je.a.utc(e).endOf("day").toDate()}}()},Ne=function(e,t){for(var a=[],n=je()(t).diff(e,"days"),r=0;r<=n;r++){var o=je.a.utc(e);a.push({x:o.add(r,"days").format("MMM D"),y:0})}return a},ke=function(e){var t=e.data,a=e.previousData,n=e.formattedDate,r=e.label,o=e.previousLabel,i=t-a,l="".concat(t," ").concat(r," ").concat(n);return null===a||0===i?l:"".concat(l,"\n ").concat(i>-1?"+":"").concat(i," ").concat(o)},we=function(e){var t=e.empty,a=e.maxY,n=void 0===a?0:a,r={x:[0,31]};return r.y=t||n<50?[0,10*Math.ceil((n+1)/10)]:[0,Math.pow(10,n.toString().length)],r},Ge=function(e){var t=e.chartData,a=e.xAxisTickInterval,n=void 0===a?5:a;return t.reduce(function(e,t,a){return a%n===0?e.concat(t.x):e},[])},xe=function(e){var t=e.data,a=e.startDate,n=e.endDate,r=e.label,o=e.previousLabel,i=e.xAxisTickInterval,l=[],c={};try{for(var s={},u=0,d=0;d<t.length;d++){var p=je.a.utc(t[d][U]).format("MMM D");s[p]={x:p,y:t[d][j]},u=s[p].y>u?s[p].y:u}c=we({maxY:u}),t.length&&(l=function(e){for(var t=e.startDate,a=e.endDate,n=e.values,r=e.label,o=e.previousLabel,i=je()(a).diff(t,"days"),l=[],c=0;c<=i;c++){var s=je.a.utc(t).add(c,"days").format("MMM D"),u=ke({data:n[s]?n[s].y:0,previousData:c>0?l[c-1].y:null,formattedDate:s,label:r,previousLabel:o});n[s]?l.push({x:n[s].x,y:n[s].y,label:u}):l.push({x:s,y:0,label:u})}return l}({startDate:a,endDate:n,values:s,label:r,previousLabel:o}))}catch(h){E.TEST_MODE||console.warn("Malformed API response ".concat(h.message))}return l.length||(l=Ne(a,n),c=we({empty:!0})),{chartData:l,chartDomain:c,tickValues:Ge({chartData:l,xAxisTickInterval:i})}},He=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(v.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={dropdownIsOpen:!1,chartWidth:0},a.containerRef=c.a.createRef(),a.onResizeContainer=function(){var e=a.containerRef.current;e&&e.clientWidth&&a.setState({chartWidth:e.clientWidth})},a.onSelect=function(){a.setState(function(e){return{dropdownIsOpen:!e.state.dropdownIsOpen}})},a.onToggle=function(e){a.setState({dropdownIsOpen:e})},a}return Object(_.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props,a=t.getGraphReports,n=t.startDate,r=t.endDate;a((e={},Object(Oe.a)(e,M,"daily"),Object(Oe.a)(e,N,n.toISOString()),Object(Oe.a)(e,k,r.toISOString()),e)),this.onResizeContainer(),window.addEventListener("resize",this.onResizeContainer)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResizeContainer)}},{key:"renderChart",value:function(){var e=this.state.chartWidth,t=this.props,a=t.graphData,n=t.t,r=t.startDate,o=t.endDate,i=xe({data:a.usage,startDate:r,endDate:o,label:n("curiosity-graph.tooltipLabel","sockets on"),previousLabel:n("curiosity-graph.tooltipPreviousLabel","from previous day")}),l=i.chartData,s=i.chartDomain,u=i.tickValues;return c.a.createElement(Te.a,{height:275,domainPadding:{x:[30,25]},padding:{bottom:75,left:50,right:50,top:50},domain:s,width:e},c.a.createElement(Se.a,{tickValues:u,fixLabelOverlap:!0}),c.a.createElement(Se.a,{dependentAxis:!0,showGrid:!0}),c.a.createElement(Ie.a,null,c.a.createElement(Le.a,{data:l,labelComponent:c.a.createElement(Ce.a,null)})))}},{key:"render",value:function(){var e=this.props,t=e.error,a=e.fulfilled,n=e.pending,r=e.t;this.state.dropdownIsOpen,c.a.createElement(be.a,{isDisabled:!0,onToggle:this.onToggle},r("curiosity-graph.dropdownDefault","Last 30 Days"));return c.a.createElement(Re.a,{className:"curiosity-usage-graph fadein"},c.a.createElement(ye.a,null,c.a.createElement("h2",null,r("curiosity-graph.heading","Daily CPU socket usage")),c.a.createElement(Pe.a,null,c.a.createElement(De.a,{className:"curiosity-usage-graph-label"},r("curiosity-graph.dropdownDefault","Last 30 Days")),!1)),c.a.createElement(Ae.a,null,c.a.createElement("div",{className:"curiosity-skeleton-container",ref:this.containerRef},n&&c.a.createElement(c.a.Fragment,null,c.a.createElement(g.Skeleton,{size:g.SkeletonSize.xs}),c.a.createElement(g.Skeleton,{size:g.SkeletonSize.sm}),c.a.createElement(g.Skeleton,{size:g.SkeletonSize.md}),c.a.createElement(g.Skeleton,{size:g.SkeletonSize.lg})),(a||t)&&this.renderChart())))}}]),t}(c.a.Component);He.defaultProps={error:!1,fulfilled:!1,getGraphReports:E.noop,graphData:{usage:[]},pending:!1,t:E.noopTranslate,startDate:Me.defaultDateTime.start,endDate:Me.defaultDateTime.end};var ze=_e(function(e){return Object(p.a)({},e.rhelGraph)},function(e){return{getGraphReports:function(t){return e(me.rhel.getGraphReports(t))}}})(He),Ve=function(e){function t(){return Object(h.a)(this,t),Object(v.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(g.PageHeader,null,c.a.createElement(g.PageHeaderTitle,{title:"Red Hat Enterprise Linux"})),c.a.createElement(O.a,null,c.a.createElement(ze,null)))}}]),t}(c.a.Component);Ve.defaultProps={};var Fe=ge(function(){return{}},function(){return{}})(Ve),We=(E.TEST_MODE?"/":E.DEV_MODE&&"/")||function(e){var t=e.pathName,a=e.pathPrefix,n=t.split("/");n.shift();var r=a&&new RegExp(n[0]).test(a)?3:2;return"/".concat(n.slice(0,r).join("/"))}({pathName:window.location.pathname,pathPrefix:E.UI_DEPLOY_PATH_PREFIX}),Ye=[{title:"Red Hat Enterprise Linux",id:"rhel",to:"/rhel",redirect:!0,component:Fe,exact:!0,disabled:E.UI_DISABLED}],Be=a(629),Xe=a(628),Je=function(e){function t(){return Object(h.a)(this,t),Object(v.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.i18nInit()}},{key:"componentDidUpdate",value:function(e){this.props.locale!==e.locale&&this.i18nInit()}},{key:"i18nInit",value:function(){var e=this.props,t=e.fallbackLng,a=e.loadPath,n=e.locale;Be.a.use(Xe.a).use(R.a).init({backend:{loadPath:a},fallbackLng:t,lng:n,debug:!E.PROD_MODE,ns:["default"],defaultNS:"default",react:{useSuspense:!1}})}},{key:"render",value:function(){var e=this.props.children;return c.a.createElement(c.a.Fragment,null,e)}}]),t}(c.a.Component);Je.defaultProps={fallbackLng:"en-US",loadPath:"/beta/apps/subscriptions/locales/{{lng}}.json",locale:null};var qe=function(e){function t(){return Object(h.a)(this,t),Object(v.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(f.a)(t,[{key:"renderRoutes",value:function(){var e=this.props.routesType,t=null;return{renderRoutes:e.map(function(e){return e.disabled?null:(!0===e.redirect&&(t=c.a.createElement(b.c,{to:e.to})),c.a.createElement(b.d,{exact:e.hasParameters||e.exact,key:e.to,path:e.to,component:e.component}))}),redirectRoot:t}}},{key:"render",value:function(){var e=this.renderRoutes(),t=e.renderRoutes,a=e.redirectRoot;return c.a.createElement("div",{className:"curiosity-content"},c.a.createElement(b.g,null,t,a))}}]),t}(c.a.Component);qe.defaultProps={routesType:Ye};var Ke=a(378),Qe=a(380),Ze=a(379),$e=a(386),et=a(385),tt=a(154),at=function(e){var t=e.children;return c.a.createElement(tt.a,{className:"layout-pf curiosity"},c.a.createElement(O.a,{noPadding:!0},t))};at.defaultProps={};var nt=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(v.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).appNav=E.noop,a.buildNav=E.noop,a.buildNavigation=function(){var e=a.props.routes,t=window.location.pathname.split("/").slice(-1)[0];return e.map(function(e){return Object(p.a)({},e,{active:e.id===t})})},a}return Object(_.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.appName,n=t.authorizeUser,r=t.history,o=t.insights,i=t.routes,l=t.session;try{(E.PROD_MODE||E.REVIEW_MODE)&&o.chrome.init(),E.PROD_MODE&&(o.chrome.identifyApp(a),o.chrome.navigation(i),this.appNav=o.chrome.on("APP_NAVIGATION",function(e){return r.push("/".concat(e.navId))}),this.buildNav=r.listen(function(){return o.chrome.navigation(e.buildNavigation())})),l.authorized||n()}catch(c){E.TEST_MODE||console.warn("{ init, identifyApp, navigation } = insights.chrome: ".concat(c.message))}}},{key:"componentWillUnmount",value:function(){this.appNav(),this.buildNav()}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.session;return a.authorized?c.a.createElement(c.a.Fragment,null,t):a.pending?c.a.createElement(at,null,c.a.createElement(g.PageHeader,null,c.a.createElement(g.PageHeaderTitle,{title:"\xa0"})),c.a.createElement(Ke.a,{variant:Ke.b.full,className:"fadein"},c.a.createElement(Qe.a,{icon:$e.a}),c.a.createElement(Ze.a,null,"Authenticating..."))):c.a.createElement(at,null,c.a.createElement(g.PageHeader,null,c.a.createElement(g.PageHeaderTitle,{title:"Unauthorized"})),c.a.createElement(Ke.a,{variant:Ke.b.full,className:"fadein"},c.a.createElement(Qe.a,{icon:et.a}),c.a.createElement(Ze.a,null,"You do not have permission to access reporting. Contact your administrator.")))}}]),t}(l.Component);nt.defaultProps={appName:E.UI_NAME,authorizeUser:E.noop,insights:window.insights,routes:Ye,session:{authorized:!1,error:!1,errorMessage:"",pending:!1}};var rt=ge(function(e){return{session:e.user.session}},function(e){return{authorizeUser:function(){return e(me.user.authorizeUser())}}})(nt),ot=function(e){function t(){return Object(h.a)(this,t),Object(v.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.getLocale)()}},{key:"render",value:function(){var e=this.props.locale;return c.a.createElement(Je,{locale:e&&e.value||null},c.a.createElement(rt,null,c.a.createElement(at,null,c.a.createElement(qe,null))))}}]),t}(c.a.Component);ot.defaultProps={getLocale:E.noop,locale:{}};var it=ge(function(e){return{locale:e.user.session.locale}},function(e){return{getLocale:function(){return e(me.user.getLocale())}}})(ot);a(1452);Object(s.render)(c.a.createElement(u.Provider,{store:ne},c.a.createElement(d.BrowserRouter,{basename:We},c.a.createElement(it,null))),document.getElementById("root"))},636:function(e,t,a){e.exports=a(1453)}},[[636,1,2]]]);
//# sourceMappingURL=main.b43d3e72.chunk.js.map