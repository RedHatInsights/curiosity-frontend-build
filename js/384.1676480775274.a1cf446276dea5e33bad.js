"use strict";(self.webpackChunkcuriosity_frontend=self.webpackChunkcuriosity_frontend||[]).push([[384],{90384:function(e,t,n){n.r(t),n.d(t,{FormState:function(){return Z},default:function(){return Z}});var s=n(4942),i=n(1413),a=n(15671),u=n(43144),r=n(97326),o=n(60136),l=n(54062),c=n(92950),d=n.n(c),h=n(50361),v=n.n(h),p=n(18446),f=n.n(p),m=n(62834),V={isUpdating:!1,isSubmitting:!1,isValid:null,isValidating:!1,submitCount:0},Z=function(e){(0,o.Z)(n,e);var t=(0,l.Z)(n);function n(e){var u;return(0,a.Z)(this,n),(u=t.call(this,e)).state=(0,i.Z)({},V),u.onEventCustom=function(e){var t=Array.isArray(e)&&e||e&&[e];t.length&&t.filter((function(e){return"name"in e&&("value"in e||"checked"in e)})).forEach((function(e){return u.onEvent({target:(0,i.Z)({},e),persist:m.Z.noop,type:"custom"})}))},u.onEvent=function(e){var t=(0,r.Z)(u),n=t.touched,a=t.values,o=e.options?(0,i.Z)({},e):e.target,l=o.id,c=o.name,d=o.value,h=o.checked;e.persist();var v=c||l||"generated form state target, add name or id attr to field";u.touched=(0,i.Z)((0,i.Z)({},n),{},(0,s.Z)({},v,!0)),u.values=(0,i.Z)((0,i.Z)({},a),{},(0,s.Z)({},v,d)),void 0!==h&&(u.checked=(0,i.Z)((0,i.Z)({},u.checked),{},(0,s.Z)({},v,h))),u.setState({isUpdating:!0,isValidating:!0},(function(){return u.validate(e).then((function(e){var t=(0,i.Z)({},e&&e[0]||e||{}),n=!Object.values(t).filter((function(e){return!0===e})).length;u.errors=t,u.setState({isUpdating:!1,isValid:n,isValidating:!1})}))}))},u.onReset=function(e){var t=(0,r.Z)(u),s=t.refValues,a=t.values,o=u.props,l=o.setValuesAssumeBoolIsChecked,c=o.onReset,d=o.resetUsingSetValues;e.persist();var h=s&&!0===d,p=h&&v()(s)||{},f=h&&n.checkedSetValues(l,p)||{};u.values=p,u.checked=f,u.errors={},u.touched={},u.setState((0,i.Z)({},V)),c(h?(0,i.Z)({event:e},v()({values:p,prevValues:a})):(0,i.Z)({event:e,values:{}},v()({prevValues:a})))},u.onSubmit=function(e){var t=u.state.submitCount;e.persist(),e.preventDefault(),u.setState({submitCount:t+1,isSubmitting:!0,isUpdating:!0,isValidating:!0},(function(){return u.validate(e).then((function(t){var n=(0,i.Z)({},t&&t[0]||t||{}),s=!Object.values(n).filter((function(e){return!0===e})).length;u.errors=n,u.touched={},u.setState({isValid:s,isValidating:!1},(function(){return s&&u.submit(e).then((function(){u.setState({isSubmitting:!1,isUpdating:!1})}))}))}))}))},u.touched={},u.checked=n.checkedSetValues(e),u.refValues=!0===e.resetUsingSetValues||!0===e.setValuesOnUpdate?v()(e.setValues):null,u.errors={},u.values=v()(e.setValues),u}return(0,u.Z)(n,[{key:"componentDidMount",value:function(){!0===this.props.validateOnMount&&this.validateOnMount()}},{key:"componentDidUpdate",value:function(){var e=this.refValues,t=this.props,n=t.setValuesOnUpdate,s=t.setValues;!0!==n||f()(e,s)||this.updateComponentValues()}},{key:"submit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"submit"},t=this.checked,s=this.errors,a=this.values,u=this.touched,r=this.props.onSubmit,o=r((0,i.Z)({event:e},v()((0,i.Z)((0,i.Z)({},this.state),{},{checked:t,errors:s,values:a,touched:u}))));return n.isPromise(o)?o:{then:function(e){return e()}}}},{key:"validate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"validate"},t=this.checked,s=this.errors,a=this.values,u=this.touched,r=this.props.validate,o=r((0,i.Z)({event:e},v()((0,i.Z)((0,i.Z)({},this.state),{},{checked:t,errors:s,values:a,touched:u}))));return n.isPromise(o)?o:{then:function(e){return e(o)}}}},{key:"validateOnMount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"mount"};this.validateOnUpdate(e)}},{key:"validateOnUpdate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"update"};this.setState({isUpdating:!0,isValidating:!0},(function(){return e.validate(t).then((function(t){var n=(0,i.Z)({},t&&t[0]||t||{}),s=!Object.values(n).filter((function(e){return!0===e})).length;e.errors=n,e.setState({isUpdating:!1,isValidating:!1,isValid:s})}))}))}},{key:"updateComponentValues",value:function(){var e=this,t=this.props,s=t.setValues,i=t.setValuesAssumeBoolIsChecked,a=t.validateOnUpdate;this.setState({isUpdating:!0},(function(){e.checked=n.checkedSetValues(i,s),e.refValues=v()(s),e.values=v()(s),a?e.validateOnUpdate():e.setState({isUpdating:!1})}))}},{key:"render",value:function(){var e=this.checked,t=this.errors,n=this.values,s=this.touched,a=this.props.children;return d().createElement(d().Fragment,null,a((0,i.Z)({handleOnEventCustom:this.onEventCustom,handleOnEvent:this.onEvent,handleOnReset:this.onReset,handleOnSubmit:this.onSubmit},v()((0,i.Z)((0,i.Z)({},this.state),{},{checked:e,errors:t,values:n,touched:s})))))}}],[{key:"checkedSetValues",value:function(e){var t=e.setValuesAssumeBoolIsChecked,n=e.setValues,s={};return t&&Object.keys(n).forEach((function(e){"boolean"==typeof n[e]&&(s[e]=n[e])})),s}},{key:"isPromise",value:function(e){return"[object Promise]"===Object.prototype.toString.call(e)}}]),n}(d().Component);Z.defaultProps={onReset:m.Z.noop,onSubmit:m.Z.noop,resetUsingSetValues:!0,setValues:{},setValuesOnUpdate:!1,setValuesAssumeBoolIsChecked:!0,validate:m.Z.noop,validateOnMount:!1,validateOnUpdate:!1}}}]);
//# sourceMappingURL=../sourcemaps/384.959d2bf0b45b2efac2a663ae5ad4761d.js.map