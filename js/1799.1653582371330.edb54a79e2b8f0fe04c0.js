"use strict";(self.webpackChunkcuriosity_frontend=self.webpackChunkcuriosity_frontend||[]).push([[1799,8139],{91799:(t,e,a)=>{a.r(e),a.d(e,{default:()=>C,GraphCardChart:()=>C});var r=a(1413),n=a(96985),o=a.n(n),i=a(75857),l=a(15451),c=a(51858),u=a(25394),s=a(78139),d=a(60930),h=a(64418),p=a(44024),m=a(99171),v=a(46262),y=a(91339),g=a(1797),f=a(83109),C=function(t){var e=t.t,a=t.useGetGraphTally,n=t.useGraphCardContext,c=t.useMetricsSelector,u=t.useProduct,f=t.useProductGraphTallyQuery,C=u().productId,T=n().settings,E=void 0===T?{}:T,b=E.actionDisplay,x=E.metric,k=E.metrics,G=void 0===k?[]:k,S=f()[v.O6.GRANULARITY],D=c(),P=D.pending,L=D.error,_=D.data,F=void 0===_?{}:_,A=D.dataSets,I=void 0===A?[]:A,M=a();(0,l.Z)((function(){M(G.map((function(t){var e=t.id;return{id:C,metric:e}})))}),[G,C,M]);var U=(null==x?void 0:x.id)&&"_".concat(null==x?void 0:x.id)||"",N=null;return"function"==typeof b&&(N=b({data:(0,r.Z)({},F)})),o().createElement(i.Card,{className:"curiosity-usage-graph"},o().createElement(y.MinHeight,{key:"headerMinHeight"},o().createElement(i.CardHeader,null,o().createElement(i.CardTitle,null,o().createElement(i.Title,{headingLevel:"h2",size:"lg"},e("curiosity-graph.cardHeading".concat(U),{context:C}),o().createElement(m.GraphCardChartTitleTooltip,null))),N&&o().createElement(i.CardActions,{className:L?"blur":""},N))),o().createElement(y.MinHeight,{key:"bodyMinHeight"},o().createElement(i.CardBody,null,o().createElement("div",{className:(L?"blur":P&&"fadein")||""},P&&o().createElement(g.Loader,{variant:"graph"}),!P&&o().createElement(d.Chart,Object.assign({},s.graphCardHelpers.generateExtendedChartSettings({settings:E,granularity:S}),{dataSets:I,chartLegend:function(t){var e=t.chart,a=t.datum;return o().createElement(h.GraphCardChartLegend,{chart:e,datum:a})},chartTooltip:function(t){var e=t.datum;return o().createElement(p.GraphCardChartTooltip,{datum:e})}}))))))};C.defaultProps={t:f.translate,useGetGraphTally:u.useGetGraphTally,useGraphCardContext:u.useGraphCardContext,useMetricsSelector:u.useMetricsSelector,useProduct:c.useProduct,useProductGraphTallyQuery:c.useProductGraphTallyQuery}},64418:(t,e,a)=>{a.r(e),a.d(e,{default:()=>h,GraphCardChartLegend:()=>h});var r=a(96985),n=a.n(r),o=a(75857),i=a(89048),l=a(51858),c=a(61072),u=a(76006),s=a(83109),d=a(1138),h=function(t){var e=t.chart,a=t.datum,r=t.t,l=t.useDispatch,u=t.useSelectors,s=(0,t.useProduct)(),h=s.productLabel,p=s.viewId,m=l(),v=u(a.dataSets.map((function(t){var e=t.id;return function(t){var a;return null===(a=t.graph.legend)||void 0===a?void 0:a["".concat(p,"-").concat(e)]}})));(0,i.Z)((function(){a.dataSets.forEach((function(t,a){var r=t.id;((null==v?void 0:v[a])||e.isToggled(r))&&e.hide(r)}))}));var y=function(t){var a=e.toggle(t);m({type:c.JD.graph.SET_GRAPH_LEGEND,id:"".concat(p,"-").concat(t),value:a})};return n().createElement(n().Fragment,null,a.dataSets.map((function(t,a){var i=t.id,l=t.isThreshold,c=t.stroke,u=t.data,s=!(void 0===u?[]:u).find((function(t){var e=t.y,a=t.hasData;return e>=0&&!0===a||e>=0&&!0===l}))||!1,p=r(["curiosity-graph.label_".concat(l?"threshold":i),"curiosity-graph.label_no"],{product:h,context:h}),m=r("curiosity-graph.legendTooltip".concat(l?"_threshold":"","_").concat(i),{product:h,context:h},[n().createElement("span",{style:{whiteSpace:"nowrap"}})]),g=(null==v?void 0:v[a])||e.isToggled(i),f=n().createElement(o.Button,{onClick:function(){return y(i)},onKeyPress:function(){return y(i)},className:"curiosity-usage-graph__legend-item",tabIndex:0,key:"curiosity-button-".concat(i),variant:"link",component:"a",isDisabled:s,icon:(s||g)&&n().createElement(d.ChartIcon,{symbol:"eyeSlash"})||n().createElement(d.ChartIcon,{symbol:l?"dash":"square",style:{visibility:s||g?"hidden":"visible"},fill:c})},p);return m?n().createElement(o.Tooltip,{key:"curiosity-tooltip-".concat(i),content:n().createElement("p",null,m),position:o.TooltipPosition.top,enableFlip:!0,distance:5},f):f})))};h.defaultProps={chart:{hide:u.BM.noop,toggle:u.BM.noop,isToggled:u.BM.noop},datum:{dataSets:[]},t:s.translate,useDispatch:c.Cr.reactRedux.useDispatch,useSelectors:c.Cr.reactRedux.useSelectors,useProduct:l.useProduct}},99171:(t,e,a)=>{a.r(e),a.d(e,{default:()=>s,GraphCardChartTitleTooltip:()=>s});var r=a(96985),n=a.n(r),o=a(75857),i=a(36100),l=a(51858),c=a(25394),u=a(83109),s=function(t){var e=t.t,a=t.useGraphCardContext,r=(0,t.useProduct)().productId,l=a().settings,c=void 0===l?{}:l,u=c.isCardTitleDescription,s=c.metric,d=(null==s?void 0:s.id)&&"_".concat(null==s?void 0:s.id)||"";return u?n().createElement(o.Tooltip,{content:n().createElement("p",null,e("curiosity-graph.cardHeadingDescription".concat(d),{context:r})),position:o.TooltipPosition.top,enableFlip:!1,distance:5,entryDelay:100,exitDelay:0},n().createElement("span",{className:"curiosity-icon__question"},n().createElement(i.OutlinedQuestionCircleIcon,null))):null};s.defaultProps={t:u.translate,useProduct:l.useProduct,useGraphCardContext:c.useGraphCardContext}},44024:(t,e,a)=>{a.r(e),a.d(e,{default:()=>d,GraphCardChartTooltip:()=>d});var r=a(96985),n=a.n(r),o=a(51858),i=a(78139),l=a(83109),c=a(1138),u=a(46262),s=a(76006),d=function(t){var e=t.datum,a=t.t,r=t.useProduct,o=t.useProductGraphTallyQuery,l=r().productLabel,d=o()[u.O6.GRANULARITY],h=null,p=[],m=(e||{}).itemsByKey,v=void 0===m?{}:m;return Object.keys(v).reverse().forEach((function(t,e){var r,o,u,s;0===e&&(h=(0,i.getTooltipDate)({date:null===(s=v[t])||void 0===s?void 0:s.data.date,granularity:d}));var m={color:null===(r=v[t])||void 0===r?void 0:r.color};if("threshold"===(null===(o=v[t])||void 0===o?void 0:o.chartType)){var y,g,f,C=null!==(y=null===(g=v[t])||void 0===g?void 0:g.data.y)&&void 0!==y?y:a("curiosity-graph.label_noData");null!==(f=v[t])&&void 0!==f&&f.data.hasInfinite&&(C=m.color?n().createElement(c.ChartIcon,{symbol:"infinity",fill:"#ffffff",title:a("curiosity-graph.label_threshold",{context:"infinite"})}):a("curiosity-graph.label_threshold",{context:"infinite"})),m.label=a("curiosity-graph.label_threshold"),m.value=C}else{var T,E,b=!1===(null===(T=v[t])||void 0===T?void 0:T.data.hasData)&&a("curiosity-graph.label_noData")||(null===(E=v[t])||void 0===E?void 0:E.data.y)||0;m.label=a("curiosity-graph.label",{context:t,product:l}),m.value=b}m.chartType=null===(u=v[t])||void 0===u?void 0:u.chartType,p.push(m)})),n().createElement("div",{className:"curiosity-usage-graph__tooltip"},n().createElement("table",{summary:a("curiosity-graph.tooltipSummary")},p.length&&h&&n().createElement("thead",null,n().createElement("tr",null,n().createElement("th",{colSpan:2},h)))||null,p.length&&n().createElement("tbody",null,p.map((function(t){var e,a,r="number"==typeof t.value&&!Number.isInteger(t.value)&&(null===(e=s.BM.numberDisplay(t.value))||void 0===e||null===(a=e.format({average:!0,mantissa:5,trimMantissa:!0,lowPrecision:!0}))||void 0===a?void 0:a.toUpperCase())||t.value;return n().createElement("tr",{key:"tooltip-".concat(t.label)},n().createElement("th",null,"threshold"===t.chartType&&n().createElement(c.ChartIcon,{size:"sm",symbol:"dash",fill:t.color||"transparent"}),"threshold"!==t.chartType&&n().createElement(c.ChartIcon,{size:"sm",fill:t.color||"transparent"})," ",t.label),n().createElement("td",null,r))})))||null),!p.length&&a("curiosity-graph.label_noData",{context:"error"})||null)};d.defaultProps={datum:{},t:l.translate,useProduct:o.useProduct,useProductGraphTallyQuery:o.useProductGraphTallyQuery}},25394:(t,e,a)=>{a.r(e),a.d(e,{default:()=>p,context:()=>p,GraphCardContext:()=>u,DEFAULT_CONTEXT:()=>c,useGetGraphTally:()=>d,useGraphCardContext:()=>s,useMetricsSelector:()=>h});var r=a(1413),n=a(96985),o=a.n(n),i=a(61072),l=a(51858),c=[{settings:{isStandalone:!1,metrics:[],metric:void 0}},a(62834).B.noop],u=o().createContext(c),s=function(){return(0,n.useContext)(u)},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.useDispatch,a=void 0===e?i.Cr.reactRedux.useDispatch:e,r=t.useProductGraphTallyQuery,n=void 0===r?l.useProductGraphTallyQuery:r,o=n(),c=a();return function(t){return i.Ak.rhsm.getGraphTally(t,o)(c)}},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.useGraphCardContext,a=void 0===e?s:e,n=t.useSelectors,o=void 0===n?i.Cr.reactRedux.useSelectors:n,c=t.useProduct,u=void 0===c?l.useProduct:c,d=u(),h=d.productId,p=a(),m=p.settings,v=void 0===m?{}:m,y=v.metrics,g=void 0===y?[]:y,f={},C=o(g.map((function(t){var e=t.id;return function(t){var a;return null===(a=t.graph.tally)||void 0===a?void 0:a["".concat(h,"_").concat(e)]}})),[]),T=!1,E=!1,b=0,x=C.map((function(t,e){var a,n,o=t||{},i=o.pending,l=o.fulfilled,c=o.error,u=o.cancelled;!(!i&&!u)&&(T=!0),l&&(E=!0),c&&(b+=1);var s=(0,r.Z)((0,r.Z)({},g[e]),{},{data:(null==t||null===(a=t.data)||void 0===a?void 0:a.data)||[],meta:(null==t||null===(n=t.data)||void 0===n?void 0:n.meta)||{}});return f[g[e].id]=s,s})),k={data:f,dataSets:x,error:!1,fulfilled:!1,pending:!1};return b===x.length?k.error=!0:T?k.pending=!0:E&&(k.fulfilled=!0),k},p={GraphCardContext:u,DEFAULT_CONTEXT:c,useGetGraphTally:d,useGraphCardContext:s,useMetricsSelector:h}},78139:(t,e,a)=>{a.r(e),a.d(e,{default:()=>g,graphCardHelpers:()=>g,generateChartSettings:()=>d,generateExtendedChartSettings:()=>y,getChartXAxisLabelIncrement:()=>h,getTooltipDate:()=>p,xAxisTickFormat:()=>m,yAxisTickFormat:()=>v});var r=a(1413),n=a(45987),o=a(30381),i=a.n(o),l=a(98454),c=a(30446),u=a(76006),s=["id","isStandalone","isThreshold"],d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[],a=[];return t.forEach((function(t){var o=t.id,i=t.isStandalone,c=void 0!==i&&i,u=t.isThreshold,d=void 0!==u&&u,h=(0,n.Z)(t,s);if(o){var p={id:o,isStacked:!d,isStandalone:c,isThreshold:d,strokeWidth:2};d&&(p.stroke=l.chart_color_green_300.value,p.strokeDasharray="4,3",p.strokeWidth=3),c?e.push((0,r.Z)((0,r.Z)({},p),h)):a.push((0,r.Z)((0,r.Z)({},p),h))}})),{standaloneFilters:e,groupedFilters:a}},h=function(t){switch(t){case c.U9.DAILY:return 5;case c.U9.WEEKLY:case c.U9.MONTHLY:return 2;case c.U9.QUARTERLY:default:return 1}},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.date,a=t.granularity,r=i().utc(e);switch(a){case c.U9.QUARTERLY:return"".concat(r.format(u.i3.timestampQuarterFormats.yearShort)," - ").concat(r.add(1,"quarter").format(u.i3.timestampQuarterFormats.yearShort));case c.U9.MONTHLY:return r.format(u.i3.timestampMonthFormats.yearLong);case c.U9.WEEKLY:return"".concat(r.format(u.i3.timestampDayFormats.short)," - ").concat(r.add(1,"week").format(u.i3.timestampDayFormats.yearShort));case c.U9.DAILY:default:return r.format(u.i3.timestampDayFormats.long)}},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.callback,a=t.date,r=t.granularity,n=t.tick,o=t.previousDate;if(a&&r){if(e)return e({callback:e,date:a,granularity:r,tick:n,previousDate:o});var l,s=i().utc(a),d=0!==n&&Number.parseInt(s.year(),10)!==Number.parseInt(i().utc(o).year(),10);switch(r){case c.U9.QUARTERLY:l=(l=d?s.format(u.i3.timestampQuarterFormats.yearShort):s.format(u.i3.timestampQuarterFormats.short)).replace(/\s/,"\n");break;case c.U9.MONTHLY:l=(l=d?s.format(u.i3.timestampMonthFormats.yearShort):s.format(u.i3.timestampMonthFormats.short)).replace(/\s/,"\n");break;case c.U9.WEEKLY:case c.U9.DAILY:default:l=(l=d?s.format(u.i3.timestampDayFormats.yearShort):s.format(u.i3.timestampDayFormats.short)).replace(/\s(\d{4})$/,"\n$1")}return l}},v=function(){var t,e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=a.callback,n=a.tick;return r?r({tick:n}):null===(t=u.BM.numberDisplay(n))||void 0===t||null===(e=t.format({average:!0,mantissa:1,trimMantissa:!0,lowPrecision:!1}))||void 0===e?void 0:e.toUpperCase()},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.settings,a=t.granularity;return(0,r.Z)((0,r.Z)({},e),{},{xAxisLabelIncrement:h(a),xAxisTickFormat:function(t){var r=t.item,n=t.previousItem,o=t.tick;return m({callback:null==e?void 0:e.xAxisTickFormat,tick:o,date:r.date,previousDate:n.date,granularity:a})},yAxisTickFormat:function(t){var a=t.tick;return v({callback:null==e?void 0:e.yAxisTickFormat,tick:a})}})},g={generateChartSettings:d,generateExtendedChartSettings:y,getChartXAxisLabelIncrement:h,getTooltipDate:p,xAxisTickFormat:m,yAxisTickFormat:v}}}]);
//# sourceMappingURL=../sourcemaps/1799.380116ec3701a34146dca6e22d96194b.js.map