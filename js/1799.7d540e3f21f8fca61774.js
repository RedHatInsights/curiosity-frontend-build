"use strict";(self.webpackChunksubscriptions=self.webpackChunksubscriptions||[]).push([[1799,4418,939,5394,1339],{91799:function(e,t,r){r.r(t),r.d(t,{GraphCardChart:function(){return T},default:function(){return T}});var n=r(87462),a=r(92950),o=r.n(a),l=r(45697),i=r.n(l),s=r(90154),u=r(51858),c=r(25394),d=r(78139),p=r(30211),h=r(64418),g=r(44024),m=r(99171),f=r(46262),y=r(91339),C=r(1797),v=r(83109);const T=e=>{let{t:t,useGetMetrics:r,useGraphCardActions:a,useGraphCardContext:l,useProductGraphTallyQuery:i}=e;const u=a(),{settings:c={}}=l(),{stringId:v}=c,{[f.O6.GRANULARITY]:T}=i(),{pending:b,error:E,dataSets:G=[]}=r();return o().createElement(s.Card,{isPlain:!0,className:"curiosity-usage-graph"},o().createElement(s.CardHeader,null,o().createElement(s.CardTitle,null,o().createElement(s.Title,{headingLevel:"h2",size:"lg"},t("curiosity-graph.cardHeading",{context:v}),o().createElement(m.GraphCardChartTitleTooltip,null))),u&&o().createElement(s.CardActions,{className:E?"blur":""},o().createElement(s.Toolbar,{collapseListedFiltersBreakpoint:"sm"},o().createElement(s.ToolbarContent,null,o().createElement(s.ToolbarGroup,{alignment:{default:"alignRight"}},u))))),o().createElement(y.MinHeight,{key:"bodyMinHeight"},o().createElement(s.CardBody,null,o().createElement("div",{className:(E?"blur":b&&"fadein")||""},b&&o().createElement(C.Loader,{variant:"graph"}),!b&&o().createElement(p.Chart,(0,n.Z)({},d.graphCardHelpers.generateExtendedChartSettings({settings:c,granularity:T}),{dataSets:G,chartLegend:e=>{let{chart:t,datum:r}=e;return o().createElement(h.GraphCardChartLegend,{chart:t,datum:r})},chartTooltip:e=>{let{datum:t}=e;return o().createElement(g.GraphCardChartTooltip,{datum:t})}}))))))};T.propTypes={t:i().func,useGetMetrics:i().func,useGraphCardActions:i().func,useGraphCardContext:i().func,useProductGraphTallyQuery:i().func},T.defaultProps={t:v.translate,useGetMetrics:c.useGetMetrics,useGraphCardActions:c.useGraphCardActions,useGraphCardContext:c.useGraphCardContext,useProductGraphTallyQuery:u.useProductGraphTallyQuery}},64418:function(e,t,r){r.r(t),r.d(t,{GraphCardChartLegend:function(){return f},default:function(){return f}});var n=r(87462),a=r(92950),o=r.n(a),l=r(45697),i=r.n(l),s=r(90154),u=r(89048),c=r(51858),d=r(25394),p=r(82410),h=r(76006),g=r(83109),m=r(1138);const f=e=>{let{chart:t,datum:r,t:a,useDispatch:l,useGraphCardContext:i,useSelectors:c,useProduct:d}=e;const{settings:h={}}=i(),{productLabel:g,viewId:f}=d(),{isDisabledLegendClick:y}=h,C=l(),[v,...T]=c([e=>{var t;let{graph:r}=e;return null===(t=r.legend)||void 0===t?void 0:t["".concat(f,"-inverted")]},...r.dataSets.map((e=>{let{id:t}=e;return e=>{var r;let{graph:n}=e;return null===(r=n.legend)||void 0===r?void 0:r["".concat(f,"-").concat(t)]}}))]);(0,u.Z)((()=>{r.dataSets.forEach(((e,r)=>{let{id:n,isToolbarFilter:a}=e;v&&a?new RegExp(v).test(n)||t.hide(n):((null==T?void 0:T[r])||t.isToggled(n))&&t.hide(n)}))}));const b=e=>{const r=t.toggle(e);C({type:p.JD.graph.SET_GRAPH_LEGEND,id:"".concat(f,"-").concat(e),value:r})};return o().createElement(o().Fragment,null,r.dataSets.map(((e,r)=>{let{id:l,isThreshold:i,stroke:u,data:c=[]}=e;const d=!c.find((e=>{let{y:t,hasData:r}=e;return t>=0&&!0===r||t>=0&&!0===i}))||!1,p=a(["curiosity-graph.label","curiosity-graph.label_no"],{product:g,context:l}),h=a("curiosity-graph.legendTooltip",{product:g,context:l},[o().createElement("span",{style:{whiteSpace:"nowrap"}})]),f=(null==T?void 0:T[r])||t.isToggled(l),C={};y||(C.onClick=()=>b(l),C.onKeyPress=()=>b(l));const v=o().createElement(s.Button,(0,n.Z)({},C,{className:"curiosity-usage-graph__legend-item",tabIndex:0,key:"curiosity-button-".concat(l),variant:"link",component:"a",isDisabled:null!=y?y:d,icon:(d||f)&&o().createElement(m.ChartIcon,{symbol:"eyeSlash"})||o().createElement(m.ChartIcon,{symbol:i?"dash":"square",style:{visibility:d||f?"hidden":"visible"},fill:u})}),p);return h?o().createElement(s.Tooltip,{key:"curiosity-tooltip-".concat(l),content:o().createElement("p",null,h),position:s.TooltipPosition.top,enableFlip:!0,distance:5},o().createElement("span",{className:"pf-c-button pf-m-link curiosity-usage-graph__legend-item-wrapper"},v)):v})))};f.propTypes={chart:i().shape({hide:i().func,toggle:i().func,isToggled:i().func}),datum:i().shape({dataSets:i().arrayOf(i().shape({data:i().array,id:i().string.isRequired,isThreshold:i().bool,stroke:i().string.isRequired}))}),t:i().func,useDispatch:i().func,useGraphCardContext:i().func,useProduct:i().func,useSelectors:i().func},f.defaultProps={chart:{hide:h.helpers.noop,toggle:h.helpers.noop,isToggled:h.helpers.noop},datum:{dataSets:[]},t:g.translate,useDispatch:p.Cr.reactRedux.useDispatch,useGraphCardContext:d.useGraphCardContext,useProduct:c.useProduct,useSelectors:p.Cr.reactRedux.useSelectors}},99171:function(e,t,r){r.r(t),r.d(t,{GraphCardChartTitleTooltip:function(){return d},default:function(){return d}});var n=r(92950),a=r.n(n),o=r(45697),l=r.n(o),i=r(90154),s=r(15138),u=r(25394),c=r(83109);const d=e=>{let{t:t,useGraphCardContext:r}=e;const{settings:n={}}=r(),{isCardTitleDescription:o,stringId:l}=n;return o?a().createElement(i.Tooltip,{content:a().createElement("p",null,t("curiosity-graph.cardHeadingDescription",{context:l})),position:i.TooltipPosition.top,enableFlip:!1,distance:5,entryDelay:100,exitDelay:0},a().createElement("span",{className:"curiosity-icon__question"},a().createElement(s.OutlinedQuestionCircleIcon,null))):null};d.propTypes={t:l().func,useGraphCardContext:l().func},d.defaultProps={t:c.translate,useGraphCardContext:u.useGraphCardContext}},44024:function(e,t,r){r.r(t),r.d(t,{GraphCardChartTooltip:function(){return g},default:function(){return g}});var n=r(92950),a=r.n(n),o=r(45697),l=r.n(o),i=r(51858),s=r(78139),u=r(83109),c=r(30211),d=r(1138),p=r(46262),h=r(76006);const g=e=>{let{datum:t,t:r,useProduct:n,useProductGraphTallyQuery:o}=e;const{productLabel:l}=n(),{[p.O6.GRANULARITY]:i}=o();let u=null;const g=[],{itemsByKey:m={}}=t||{};return Object.keys(m).reverse().forEach(((e,t)=>{var n,o,p,h;0===t&&(u=(0,s.getTooltipDate)({date:null===(h=m[e])||void 0===h?void 0:h.data.date,granularity:i}));const f={color:null===(n=m[e])||void 0===n?void 0:n.color};if((null===(o=m[e])||void 0===o?void 0:o.chartType)===c.ChartTypeVariant.threshold){var y,C,v,T;let t=null!==(y=null===(C=m[e])||void 0===C?void 0:C.data.y)&&void 0!==y?y:r("curiosity-graph.label",{context:"noData"});(null!==(v=m[e])&&void 0!==v&&v.data.hasInfinite||null!==(T=m[e])&&void 0!==T&&T.data.hasInfiniteQuantity)&&(t=r("curiosity-graph.label",{context:["threshold","infinite"]},[f.color&&a().createElement(d.ChartIcon,{symbol:"infinity",fill:"#ffffff",title:r("curiosity-graph.label",{context:["threshold","infinite"]})})])),f.label=r("curiosity-graph.label",{context:["threshold"]}),f.value=t}else{var b,E;const t=!1===(null===(b=m[e])||void 0===b?void 0:b.data.hasData)&&r("curiosity-graph.label",{context:"noData"})||(null===(E=m[e])||void 0===E?void 0:E.data.y)||0;f.label=r("curiosity-graph.label",{context:e,product:l}),f.value=t}f.chartType=null===(p=m[e])||void 0===p?void 0:p.chartType,g.push(f)})),a().createElement("div",{className:"curiosity-usage-graph__tooltip"},a().createElement("table",{summary:r("curiosity-graph.tooltipSummary")},g.length&&u&&a().createElement("thead",null,a().createElement("tr",null,a().createElement("th",{colSpan:2},u)))||null,g.length&&a().createElement("tbody",null,g.map((e=>{var t,r;const n="number"==typeof e.value&&!Number.isInteger(e.value)&&(null===(t=h.helpers.numberDisplay(e.value))||void 0===t||null===(r=t.format({average:!0,mantissa:5,trimMantissa:!0,lowPrecision:!0}))||void 0===r?void 0:r.toUpperCase())||e.value;return a().createElement("tr",{key:"tooltip-".concat(e.label)},a().createElement("th",null,e.chartType===c.ChartTypeVariant.threshold&&a().createElement(d.ChartIcon,{size:"sm",symbol:"dash",fill:e.color||"transparent"}),e.chartType!==c.ChartTypeVariant.threshold&&a().createElement(d.ChartIcon,{size:"sm",fill:e.color||"transparent"})," ",e.label),a().createElement("td",null,n))})))||null),!g.length&&r("curiosity-graph.label",{context:["noData","error"]})||null)};g.propTypes={datum:l().shape({itemsByKey:l().objectOf(l().shape({chartType:l().string,color:l().string,data:l().shape({date:l().oneOfType([l().string,l().instanceOf(Date)]),hasData:l().bool,hasInfinite:l().bool,hasInfiniteQuantity:l().bool,y:l().number})}))}),t:l().func,useProduct:l().func,useProductGraphTallyQuery:l().func},g.defaultProps={datum:{},t:u.translate,useProduct:i.useProduct,useProductGraphTallyQuery:i.useProductGraphTallyQuery}},25394:function(e,t,r){r.r(t),r.d(t,{DEFAULT_CONTEXT:function(){return h},GraphCardContext:function(){return g},context:function(){return T},default:function(){return T},useGetMetrics:function(){return C},useGraphCardActions:function(){return v},useGraphCardContext:function(){return m},useMetricsSelector:function(){return y},useParseFiltersSettings:function(){return f}});var n=r(87462),a=r(92950),o=r.n(a),l=r(17297),i=r(90154),s=r(82410),u=r(51858),c=r(70136),d=r(62834),p=r(78139);const h=[{settings:{metrics:[]}},d.B.noop],g=o().createContext(h),m=()=>(0,a.useContext)(g),f=function(){let{useProduct:e=u.useProduct,useProductGraphConfig:t=u.useProductGraphConfig}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{productId:r}=e(),{filters:n=[],settings:o={}}=t();return(0,a.useMemo)((()=>p.graphCardHelpers.generateChartSettings({filters:n,settings:o,productId:r})),[n,o,r])},y=function(){let{useGraphCardContext:e=m,useSelectorsResponse:t=s.Cr.reactRedux.useSelectorsResponse}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{settings:r={}}=e(),{metrics:n=[]}=r,{error:a,fulfilled:o,pending:l,data:i=[],...u}=t(n.map((e=>{let{id:t,isCapacity:r}=e;return e=>{var n,a;let{graph:o}=e;return r?null===(n=o.capacity)||void 0===n?void 0:n[t]:null===(a=o.tally)||void 0===a?void 0:a[t]}}))),c={},d=null==i?void 0:i.map(((e,t)=>{const r={...n[t],...e};return c[n[t].id]=r,r}));return{...u,data:c,dataSets:d,error:a,fulfilled:o,pending:l}},C=function(){let{getGraphMetrics:e=s.Ak.rhsm.getGraphMetrics,useDispatch:t=s.Cr.reactRedux.useDispatch,useGraphCardContext:r=m,useMetricsSelector:n=y,useProduct:a=u.useProduct,useProductGraphTallyQuery:o=u.useProductGraphTallyQuery}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{productId:i}=a(),c=o(),d=t(),p=n(),{settings:h={}}=r(),{metrics:g=[]}=h;return(0,l.Z)((()=>{const t=g.map((e=>{let{metric:t,isCapacity:r,query:n}=e;return{id:i,metric:t,isCapacity:r,query:n}}));e(t,c)(d)}),[g,i,c]),p},v=function(){let{categoryOptions:e=c.toolbarFieldOptions,useMetricsSelector:t=y,useGraphCardContext:r=m}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{pending:l,dataSets:s}=t(),{settings:u={}}=r(),{actions:p}=u;return(0,a.useMemo)((()=>null==p?void 0:p.map((t=>{let{id:r,content:a,...u}=t;const c=e.find((e=>{let{value:t}=e;return r===t})),{component:p}=c||{};return p&&o().createElement(i.ToolbarItem,{key:"option-".concat(r)},o().createElement(p,(0,n.Z)({isFilter:!1},u)))||a&&!l&&s.length&&o().createElement(i.ToolbarItem,{key:r||d.B.generateId()},"function"==typeof a?a({data:s}):a)||null}))),[p,e,s,l])},T={GraphCardContext:g,DEFAULT_CONTEXT:h,useGetMetrics:C,useGraphCardActions:v,useGraphCardContext:m,useMetricsSelector:y,useParseFiltersSettings:f}},91339:function(e,t,r){r.r(t),r.d(t,{MinHeight:function(){return s},default:function(){return s}});var n=r(92950),a=r.n(n),o=r(45697),l=r.n(o),i=r(70725);const s=e=>{let{children:t,isOnLoad:r,minHeight:o,useResizeObserver:l}=e;const[i,s]=(0,n.useState)({containerWidth:void 0,isLoaded:!1}),u=(0,n.useRef)(null),c=(0,n.useRef)(null),{height:d,width:p}=l(u);return(0,n.useEffect)((()=>{if(!r||r&&!i.isLoaded){const{current:e={}}=u,{current:t={}}=c;if(null!=e&&e.style){let n=(null==t?void 0:t.clientHeight)||0;o>d&&(n=o),e.style.minHeight="".concat(n,"px"),s((()=>({containerWidth:p,isLoaded:r,updatedHeight:n})))}}}),[d,p,u,c,r,o,i.isLoaded]),a().createElement("div",{className:"curiosity-minheight",ref:u},a().createElement("div",{className:"curiosity-minheight__inner",ref:c},t))};s.propTypes={children:l().node.isRequired,minHeight:l().number,isOnLoad:l().bool,useResizeObserver:l().func},s.defaultProps={isOnLoad:!1,minHeight:0,useResizeObserver:i.yU}}}]);
//# sourceMappingURL=../sourcemaps/1799.af5e73b1eb04df858b634052b25da311.js.map