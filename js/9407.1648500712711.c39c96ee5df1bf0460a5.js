"use strict";(self.webpackChunkcuriosity_frontend=self.webpackChunkcuriosity_frontend||[]).push([[9407,1339],{25394:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m,context:()=>m,GraphCardContext:()=>c,DEFAULT_CONTEXT:()=>s,useGetGraphTally:()=>d,useGraphCardContext:()=>u,useMetricsSelector:()=>h});var a=r(1413),n=r(96985),i=r.n(n),o=r(20169),l=r(51858),s=[{settings:{isStandalone:!1,metrics:[],metric:void 0}},r(62834).B.noop],c=i().createContext(s),u=function(){return(0,n.useContext)(c)},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.useDispatch,r=void 0===t?o.Cr.reactRedux.useDispatch:t,a=e.useProductGraphTallyQuery,n=void 0===a?l.useProductGraphTallyQuery:a,i=n(),s=r();return function(e){return o.Ak.rhsm.getGraphTally(e,i)(s)}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.useGraphCardContext,r=void 0===t?u:t,n=e.useSelectors,i=void 0===n?o.Cr.reactRedux.useSelectors:n,s=e.useProduct,c=void 0===s?l.useProduct:s,d=c(),h=d.productId,m=r(),p=m.settings,v=void 0===p?{}:p,f=v.metrics,y=void 0===f?[]:f,g={},C=i(y.map((function(e){var t=e.id;return function(e){var r;return null===(r=e.graph.tally)||void 0===r?void 0:r["".concat(h,"_").concat(t)]}})),[]),E=!1,M=!1,T=0,S=C.map((function(e,t){var r,n,i=e||{},o=i.pending,l=i.fulfilled,s=i.error,c=i.cancelled;!(!o&&!c)&&(E=!0),l&&(M=!0),s&&(T+=1);var u=(0,a.Z)((0,a.Z)({},y[t]),{},{data:(null==e||null===(r=e.data)||void 0===r?void 0:r.data)||[],meta:(null==e||null===(n=e.data)||void 0===n?void 0:n.meta)||{}});return g[y[t].id]=u,u})),x={data:g,dataSets:S,error:!1,fulfilled:!1,pending:!1};return T===S.length?x.error=!0:E?x.pending=!0:M&&(x.fulfilled=!0),x},m={GraphCardContext:c,DEFAULT_CONTEXT:s,useGetGraphTally:d,useGraphCardContext:u,useMetricsSelector:h}},29407:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g,GraphCardMetricTotals:()=>g});var a=r(96985),n=r.n(a),i=r(75857),o=r(30381),l=r.n(o),s=r(68929),c=r.n(s),u=r(51858),d=r(25394),h=r(91339),m=r(1797),p=r(76006),v=r(65876),f=r(46262),y=r(83109),g=function(e){var t,r,a,o,s=e.children,u=e.t,d=e.useMetricsSelector,y=(0,e.useProductGraphTallyQuery)()[f.O6.START_DATE],g=d(),C=g.pending,E=g.error,M=g.fulfilled,T=g.dataSets,S=(void 0===T?[]:T)[0]||{},x=S.data,_=void 0===x?[]:x,k=S.id,R=S.meta,z=void 0===R?{}:R,H=_[_.length-1]||{},D=H.date,F=H.hasData,G=H.y,O=_.find((function(e){return!0===e.isCurrentDate}))||{},b=O.date,w=O.hasData,P=O.y,B=z.totalMonthlyDate,N=z.totalMonthlyHasData,U=z.totalMonthlyValue,Z=v.toolbarFieldOptions.find((function(e){return e.title===y||e.value.startDate.toISOString()===y}))||{},A=Z.title,L=Z.isCurrent,Q=L?b:D,W=L?w:F,I=L?P:G;return n().createElement(i.Flex,{"data-test":"graphMetricTotals-".concat(c()(k)),className:"curiosity-usage-graph__totals"},n().createElement(i.Flex,{flex:{default:"flex_1"},direction:{default:"column"},alignSelf:{default:"alignSelfStretch"}},n().createElement(i.FlexItem,{className:"curiosity-usage-graph__totals-column"},n().createElement(i.Card,{"data-test":"graphDailyTotalCard",className:"curiosity-usage-graph__totals-column-card ".concat(E?"blur":"")},n().createElement(i.CardTitle,null,u("curiosity-graph.cardHeadingMetric_dailyTotal",{context:k,month:A})),n().createElement(h.MinHeight,{key:"currentBody"},n().createElement(i.CardBody,null,n().createElement("div",null,C&&n().createElement(m.Loader,{variant:"skeleton",skeletonProps:{size:m.SkeletonSize.lg}}),M&&u("curiosity-graph.cardBodyMetric_total",{context:W&&k||"",total:null===(t=p.BM.numberDisplay(I))||void 0===t||null===(r=t.format({average:!0,mantissa:5,trimMantissa:!0,lowPrecision:!1}))||void 0===r?void 0:r.toUpperCase()},[n().createElement("strong",{title:I,"aria-label":I})])))),n().createElement(h.MinHeight,{key:"currentFooter"},n().createElement(i.CardFooter,null,n().createElement("div",{className:W?"":"hidden"},M&&Q&&u("curiosity-graph.cardFooterMetric",{date:l().utc(Q).format(p.i3.timestampUTCTimeFormats.yearTimeShort)}))))),n().createElement(i.Card,{"data-test":"graphMonthlyTotalCard",className:"curiosity-usage-graph__totals-column-card ".concat(E?"blur":"")},n().createElement(i.CardTitle,null,u("curiosity-graph.cardHeadingMetric_monthlyTotal",{context:k,month:A})),n().createElement(h.MinHeight,{key:"totalMonthlyBody"},n().createElement(i.CardBody,null,n().createElement("div",null,C&&n().createElement(m.Loader,{variant:"skeleton",skeletonProps:{size:m.SkeletonSize.lg}}),M&&u("curiosity-graph.cardBodyMetric_total",{context:N&&k||"",total:null===(a=p.BM.numberDisplay(U))||void 0===a||null===(o=a.format({average:!0,mantissa:5,trimMantissa:!0,lowPrecision:!1}))||void 0===o?void 0:o.toUpperCase()},[n().createElement("strong",{title:U,"aria-label":U})])))),n().createElement(h.MinHeight,{key:"totalMonthlyFooter"},n().createElement(i.CardFooter,null,n().createElement("div",{className:N?"":"hidden"},M&&B&&u("curiosity-graph.cardFooterMetric",{date:l().utc(B).format(p.i3.timestampUTCTimeFormats.yearTimeShort)}))))))),n().createElement(i.Flex,{flex:{default:"flex_3"},direction:{default:"column"},alignSelf:{default:"alignSelfStretch"}},n().createElement(i.FlexItem,{className:"curiosity-usage-graph__totals-graph-column"},s)))};g.defaultProps={children:null,t:y.translate,useMetricsSelector:d.useMetricsSelector,useProductGraphTallyQuery:u.useProductGraphTallyQuery}},91339:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d,MinHeight:()=>d});var a=r(15671),n=r(43144),i=r(97326),o=r(60136),l=r(54062),s=r(96985),c=r.n(s),u=r(76006),d=function(e){(0,o.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).containerRef=c().createRef(),e.innerContainerRef=c().createRef(),e.updatedContainerWidth=0,e.resizeObserver=u.BM.noop,e.onResizeContainer=function(){var t,r,a=(0,i.Z)(e).updatedContainerWidth,n=e.props.updateOnResize,o=(null===(t=e.containerRef)||void 0===t||null===(r=t.current)||void 0===r?void 0:r.clientWidth)||0;n&&o!==a&&(e.updatedContainerWidth=o,e.setMinHeight(!0))},e}return(0,n.Z)(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props.updateOnResize;window.setTimeout((function(){e.setMinHeight()})),t&&this.setResizeObserver()}},{key:"componentDidUpdate",value:function(){var e=this;this.props.updateOnContent&&window.setTimeout((function(){e.setMinHeight()}))}},{key:"componentWillUnmount",value:function(){this.resizeObserver()}},{key:"setMinHeight",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.props.minHeight,a=this.containerRef.current,n=void 0===a?{}:a,i=this.innerContainerRef.current,o=void 0===i?{}:i;null!=n&&n.style&&(r>(e=t?(null==o?void 0:o.clientHeight)||0:(null==n?void 0:n.clientHeight)||0)&&(e=r),n.style.minHeight="".concat(e,"px"))}},{key:"setResizeObserver",value:function(){var e=this;window.addEventListener("resize",this.onResizeContainer),this.resizeObserver=function(){return window.removeEventListener("resize",e.onResizeContainer)}}},{key:"render",value:function(){var e=this.props.children;return c().createElement("div",{className:"curiosity-minheight",ref:this.containerRef},c().createElement("div",{ref:this.innerContainerRef},e))}}]),r}(c().Component);d.defaultProps={updateOnContent:!1,updateOnResize:!0,minHeight:0}}}]);
//# sourceMappingURL=../sourcemaps/9407.87535c5dbc35962c92f7f9001e5a392f.js.map