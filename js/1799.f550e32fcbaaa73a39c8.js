"use strict";(self.webpackChunksubscriptions=self.webpackChunksubscriptions||[]).push([[1799,4418,939,5394],{91799:function(e,t,r){r.r(t),r.d(t,{GraphCardChart:function(){return T},default:function(){return T}});var a=r(87462),n=r(92950),o=r.n(n),l=r(45697),s=r.n(l),i=r(90154),u=r(51858),c=r(25394),d=r(78139),p=r(30211),h=r(64418),g=r(44024),y=r(99171),m=r(46262),f=r(91339),C=r(1797),v=r(83109);const T=e=>{let{t:t,useGetMetrics:r,useGraphCardActions:n,useGraphCardContext:l,useProductGraphTallyQuery:s}=e;const u=n(),{settings:c={}}=l(),{stringId:v}=c,{[m.O6.GRANULARITY]:T}=s(),{pending:G,error:b,dataSets:E=[]}=r();return o().createElement(i.Card,{isPlain:!0,className:"curiosity-usage-graph"},o().createElement(i.CardHeader,null,o().createElement(i.CardTitle,null,o().createElement(i.Title,{headingLevel:"h2",size:"lg"},t("curiosity-graph.cardHeading",{context:v}),o().createElement(y.GraphCardChartTitleTooltip,null))),u&&o().createElement(i.CardActions,{className:b?"blur":""},o().createElement(i.Toolbar,{collapseListedFiltersBreakpoint:"sm"},o().createElement(i.ToolbarContent,null,o().createElement(i.ToolbarGroup,{alignment:{default:"alignRight"}},u))))),o().createElement(f.MinHeight,{key:"bodyMinHeight"},o().createElement(i.CardBody,null,o().createElement("div",{className:(b?"blur":G&&"fadein")||""},G&&o().createElement(C.Loader,{variant:"graph"}),!G&&o().createElement(p.Chart,(0,a.Z)({},d.graphCardHelpers.generateExtendedChartSettings({settings:c,granularity:T}),{dataSets:E,chartLegend:e=>{let{chart:t,datum:r}=e;return o().createElement(h.GraphCardChartLegend,{chart:t,datum:r})},chartTooltip:e=>{let{datum:t}=e;return o().createElement(g.GraphCardChartTooltip,{datum:t})}}))))))};T.propTypes={t:s().func,useGetMetrics:s().func,useGraphCardActions:s().func,useGraphCardContext:s().func,useProductGraphTallyQuery:s().func},T.defaultProps={t:v.translate,useGetMetrics:c.useGetMetrics,useGraphCardActions:c.useGraphCardActions,useGraphCardContext:c.useGraphCardContext,useProductGraphTallyQuery:u.useProductGraphTallyQuery}},64418:function(e,t,r){r.r(t),r.d(t,{GraphCardChartLegend:function(){return m},default:function(){return m}});var a=r(87462),n=r(92950),o=r.n(n),l=r(45697),s=r.n(l),i=r(90154),u=r(89048),c=r(51858),d=r(25394),p=r(82410),h=r(76006),g=r(83109),y=r(1138);const m=e=>{let{chart:t,datum:r,t:n,useDispatch:l,useGraphCardContext:s,useSelectors:c,useProduct:d}=e;const{settings:h={}}=s(),{productLabel:g,viewId:m}=d(),{isDisabledLegendClick:f}=h,C=l(),[v,...T]=c([e=>{var t;let{graph:r}=e;return null===(t=r.legend)||void 0===t?void 0:t["".concat(m,"-inverted")]},...r.dataSets.map((e=>{let{id:t}=e;return e=>{var r;let{graph:a}=e;return null===(r=a.legend)||void 0===r?void 0:r["".concat(m,"-").concat(t)]}}))]);(0,u.Z)((()=>{r.dataSets.forEach(((e,r)=>{let{id:a,isToolbarFilter:n}=e;v&&n?new RegExp(v).test(a)||t.hide(a):((null==T?void 0:T[r])||t.isToggled(a))&&t.hide(a)}))}));const G=e=>{const r=t.toggle(e);C({type:p.JD.graph.SET_GRAPH_LEGEND,id:"".concat(m,"-").concat(e),value:r})};return o().createElement(o().Fragment,null,r.dataSets.map(((e,r)=>{let{id:l,isThreshold:s,stroke:u,data:c=[]}=e;const d=!c.find((e=>{let{y:t,hasData:r}=e;return t>=0&&!0===r||t>=0&&!0===s}))||!1,p=n(["curiosity-graph.label","curiosity-graph.label_no"],{product:g,context:l}),h=n("curiosity-graph.legendTooltip",{product:g,context:l},[o().createElement("span",{style:{whiteSpace:"nowrap"}})]),m=(null==T?void 0:T[r])||t.isToggled(l),C={};f||(C.onClick=()=>G(l),C.onKeyPress=()=>G(l));const v=o().createElement(i.Button,(0,a.Z)({},C,{className:"curiosity-usage-graph__legend-item",tabIndex:0,key:"curiosity-button-".concat(l),variant:"link",component:"a",isDisabled:null!=f?f:d,icon:(d||m)&&o().createElement(y.ChartIcon,{symbol:"eyeSlash"})||o().createElement(y.ChartIcon,{symbol:s?"dash":"square",style:{visibility:d||m?"hidden":"visible"},fill:u})}),p);return h?o().createElement(i.Tooltip,{key:"curiosity-tooltip-".concat(l),content:o().createElement("p",null,h),position:i.TooltipPosition.top,enableFlip:!0,distance:5},o().createElement("span",{className:"pf-c-button pf-m-link curiosity-usage-graph__legend-item-wrapper"},v)):v})))};m.propTypes={chart:s().shape({hide:s().func,toggle:s().func,isToggled:s().func}),datum:s().shape({dataSets:s().arrayOf(s().shape({data:s().array,id:s().string.isRequired,isThreshold:s().bool,stroke:s().string.isRequired}))}),t:s().func,useDispatch:s().func,useGraphCardContext:s().func,useProduct:s().func,useSelectors:s().func},m.defaultProps={chart:{hide:h.helpers.noop,toggle:h.helpers.noop,isToggled:h.helpers.noop},datum:{dataSets:[]},t:g.translate,useDispatch:p.Cr.reactRedux.useDispatch,useGraphCardContext:d.useGraphCardContext,useProduct:c.useProduct,useSelectors:p.Cr.reactRedux.useSelectors}},99171:function(e,t,r){r.r(t),r.d(t,{GraphCardChartTitleTooltip:function(){return d},default:function(){return d}});var a=r(92950),n=r.n(a),o=r(45697),l=r.n(o),s=r(90154),i=r(15138),u=r(25394),c=r(83109);const d=e=>{let{t:t,useGraphCardContext:r}=e;const{settings:a={}}=r(),{isCardTitleDescription:o,stringId:l}=a;return o?n().createElement(s.Tooltip,{content:n().createElement("p",null,t("curiosity-graph.cardHeadingDescription",{context:l})),position:s.TooltipPosition.top,enableFlip:!1,distance:5,entryDelay:100,exitDelay:0},n().createElement("span",{className:"curiosity-icon__question"},n().createElement(i.OutlinedQuestionCircleIcon,null))):null};d.propTypes={t:l().func,useGraphCardContext:l().func},d.defaultProps={t:c.translate,useGraphCardContext:u.useGraphCardContext}},44024:function(e,t,r){r.r(t),r.d(t,{GraphCardChartTooltip:function(){return g},default:function(){return g}});var a=r(92950),n=r.n(a),o=r(45697),l=r.n(o),s=r(51858),i=r(78139),u=r(83109),c=r(30211),d=r(1138),p=r(46262),h=r(76006);const g=e=>{let{datum:t,t:r,useProduct:a,useProductGraphTallyQuery:o}=e;const{productLabel:l}=a(),{[p.O6.GRANULARITY]:s}=o();let u=null;const g=[],{itemsByKey:y={}}=t||{};return Object.keys(y).reverse().forEach(((e,t)=>{var a,o,p,h;0===t&&(u=(0,i.getTooltipDate)({date:null===(h=y[e])||void 0===h?void 0:h.data.date,granularity:s}));const m={color:null===(a=y[e])||void 0===a?void 0:a.color};if((null===(o=y[e])||void 0===o?void 0:o.chartType)===c.ChartTypeVariant.threshold){var f,C,v,T;let t=null!==(f=null===(C=y[e])||void 0===C?void 0:C.data.y)&&void 0!==f?f:r("curiosity-graph.label",{context:"noData"});(null!==(v=y[e])&&void 0!==v&&v.data.hasInfinite||null!==(T=y[e])&&void 0!==T&&T.data.hasInfiniteQuantity)&&(t=r("curiosity-graph.label",{context:["threshold","infinite"]},[m.color&&n().createElement(d.ChartIcon,{symbol:"infinity",fill:"#ffffff",title:r("curiosity-graph.label",{context:["threshold","infinite"]})})])),m.label=r("curiosity-graph.label",{context:["threshold"]}),m.value=t}else{var G,b;const t=!1===(null===(G=y[e])||void 0===G?void 0:G.data.hasData)&&r("curiosity-graph.label",{context:"noData"})||(null===(b=y[e])||void 0===b?void 0:b.data.y)||0;m.label=r("curiosity-graph.label",{context:e,product:l}),m.value=t}m.chartType=null===(p=y[e])||void 0===p?void 0:p.chartType,g.push(m)})),n().createElement("div",{className:"curiosity-usage-graph__tooltip"},n().createElement("table",{summary:r("curiosity-graph.tooltipSummary")},g.length&&u&&n().createElement("thead",null,n().createElement("tr",null,n().createElement("th",{colSpan:2},u)))||null,g.length&&n().createElement("tbody",null,g.map((e=>{var t,r;const a="number"==typeof e.value&&!Number.isInteger(e.value)&&(null===(t=h.helpers.numberDisplay(e.value))||void 0===t||null===(r=t.format({average:!0,mantissa:5,trimMantissa:!0,lowPrecision:!0}))||void 0===r?void 0:r.toUpperCase())||e.value;return n().createElement("tr",{key:"tooltip-".concat(e.label)},n().createElement("th",null,e.chartType===c.ChartTypeVariant.threshold&&n().createElement(d.ChartIcon,{size:"sm",symbol:"dash",fill:e.color||"transparent"}),e.chartType!==c.ChartTypeVariant.threshold&&n().createElement(d.ChartIcon,{size:"sm",fill:e.color||"transparent"})," ",e.label),n().createElement("td",null,a))})))||null),!g.length&&r("curiosity-graph.label",{context:["noData","error"]})||null)};g.propTypes={datum:l().shape({itemsByKey:l().objectOf(l().shape({chartType:l().string,color:l().string,data:l().shape({date:l().oneOfType([l().string,l().instanceOf(Date)]),hasData:l().bool,hasInfinite:l().bool,hasInfiniteQuantity:l().bool,y:l().number})}))}),t:l().func,useProduct:l().func,useProductGraphTallyQuery:l().func},g.defaultProps={datum:{},t:u.translate,useProduct:s.useProduct,useProductGraphTallyQuery:s.useProductGraphTallyQuery}},25394:function(e,t,r){r.r(t),r.d(t,{DEFAULT_CONTEXT:function(){return h},GraphCardContext:function(){return g},context:function(){return T},default:function(){return T},useGetMetrics:function(){return C},useGraphCardActions:function(){return v},useGraphCardContext:function(){return y},useMetricsSelector:function(){return f},useParseFiltersSettings:function(){return m}});var a=r(87462),n=r(92950),o=r.n(n),l=r(17297),s=r(90154),i=r(82410),u=r(51858),c=r(70136),d=r(62834),p=r(78139);const h=[{settings:{metrics:[]}},d.B.noop],g=o().createContext(h),y=()=>(0,n.useContext)(g),m=function(){let{useProduct:e=u.useProduct,useProductGraphConfig:t=u.useProductGraphConfig}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{productId:r}=e(),{filters:a=[],settings:o={}}=t();return(0,n.useMemo)((()=>p.graphCardHelpers.generateChartSettings({filters:a,settings:o,productId:r})),[a,o,r])},f=function(){let{useGraphCardContext:e=y,useSelectorsResponse:t=i.Cr.reactRedux.useSelectorsResponse}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{settings:r={}}=e(),{metrics:a=[]}=r,{error:n,fulfilled:o,pending:l,data:s=[],...u}=t(a.map((e=>{let{id:t,isCapacity:r}=e;return e=>{var a,n;let{graph:o}=e;return r?null===(a=o.capacity)||void 0===a?void 0:a[t]:null===(n=o.tally)||void 0===n?void 0:n[t]}}))),c={},d=null==s?void 0:s.map(((e,t)=>{const r={...a[t],...e};return c[a[t].id]=r,r}));return{...u,data:c,dataSets:d,error:n,fulfilled:o,pending:l}},C=function(){let{getGraphMetrics:e=i.Ak.rhsm.getGraphMetrics,useDispatch:t=i.Cr.reactRedux.useDispatch,useGraphCardContext:r=y,useMetricsSelector:a=f,useProduct:n=u.useProduct,useProductGraphTallyQuery:o=u.useProductGraphTallyQuery}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{productId:s}=n(),c=o(),d=t(),p=a(),{settings:h={}}=r(),{metrics:g=[]}=h;return(0,l.Z)((()=>{const t=g.map((e=>{let{metric:t,isCapacity:r,query:a}=e;return{id:s,metric:t,isCapacity:r,query:a}}));e(t,c)(d)}),[g,s,c]),p},v=function(){let{categoryOptions:e=c.toolbarFieldOptions,useMetricsSelector:t=f,useGraphCardContext:r=y}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{pending:l,dataSets:i}=t(),{settings:u={}}=r(),{actions:p}=u;return(0,n.useMemo)((()=>null==p?void 0:p.map((t=>{let{id:r,content:n,...u}=t;const c=e.find((e=>{let{value:t}=e;return r===t})),{component:p}=c||{};return p&&o().createElement(s.ToolbarItem,{key:"option-".concat(r)},o().createElement(p,(0,a.Z)({isFilter:!1},u)))||n&&!l&&i.length&&o().createElement(s.ToolbarItem,{key:r||d.B.generateId()},"function"==typeof n?n({data:i}):n)||null}))),[p,e,i,l])},T={GraphCardContext:g,DEFAULT_CONTEXT:h,useGetMetrics:C,useGraphCardActions:v,useGraphCardContext:y,useMetricsSelector:f,useParseFiltersSettings:m}}}]);
//# sourceMappingURL=../sourcemaps/1799.cc9f2ff719858bf6b1ca753fb9482941.js.map