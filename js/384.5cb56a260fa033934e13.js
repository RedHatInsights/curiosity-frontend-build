"use strict";(self.webpackChunksubscriptions=self.webpackChunksubscriptions||[]).push([[384],{90384:function(t,e,s){s.r(e),s.d(e,{FormState:function(){return v},default:function(){return v}});var i=s(4942),a=s(92950),n=s.n(a),o=s(45697),l=s.n(o),u=s(50361),h=s.n(u),d=s(18446),r=s.n(d),c=s(62834);const p={isUpdating:!1,isSubmitting:!1,isValid:null,isValidating:!1,submitCount:0};class v extends n().Component{static checkedSetValues(t){let{setValuesAssumeBoolIsChecked:e,setValues:s}=t;const i={};return e&&Object.keys(s).forEach((t=>{"boolean"==typeof s[t]&&(i[t]=s[t])})),i}static isPromise(t){return"[object Promise]"===Object.prototype.toString.call(t)}constructor(t){super(t),(0,i.Z)(this,"state",{...p}),(0,i.Z)(this,"onEventCustom",(t=>{const e=Array.isArray(t)&&t||t&&[t];e.length&&e.filter((t=>"name"in t&&("value"in t||"checked"in t))).forEach((t=>this.onEvent({target:{...t},persist:c.Z.noop,type:"custom"})))})),(0,i.Z)(this,"onEvent",(t=>{const{touched:e,values:s}=this,{id:i,name:a,value:n,checked:o}=t.options?{...t}:t.target;t.persist();const l=a||i||"generated form state target, add name or id attr to field";this.touched={...e,[l]:!0},this.values={...s,[l]:n},void 0!==o&&(this.checked={...this.checked,[l]:o}),this.setState({isUpdating:!0,isValidating:!0},(()=>this.validate(t).then((t=>{const e={...t&&t[0]||t||{}},s=!Object.values(e).filter((t=>!0===t)).length;this.errors=e,this.setState({isUpdating:!1,isValid:s,isValidating:!1})}))))})),(0,i.Z)(this,"onReset",(t=>{const{refValues:e,values:s}=this,{setValuesAssumeBoolIsChecked:i,onReset:a,resetUsingSetValues:n}=this.props;t.persist();const o=e&&!0===n,l=o&&h()(e)||{},u=o&&v.checkedSetValues(i,l)||{};this.values=l,this.checked=u,this.errors={},this.touched={},this.setState({...p}),a(o?{event:t,...h()({values:l,prevValues:s})}:{event:t,values:{},...h()({prevValues:s})})})),(0,i.Z)(this,"onSubmit",(t=>{const{submitCount:e}=this.state;t.persist(),t.preventDefault(),this.setState({submitCount:e+1,isSubmitting:!0,isUpdating:!0,isValidating:!0},(()=>this.validate(t).then((e=>{const s={...e&&e[0]||e||{}},i=!Object.values(s).filter((t=>!0===t)).length;this.errors=s,this.touched={},this.setState({isValid:i,isValidating:!1},(()=>i&&this.submit(t).then((()=>{this.setState({isSubmitting:!1,isUpdating:!1})}))))}))))})),this.touched={},this.checked=v.checkedSetValues(t),this.refValues=!0===t.resetUsingSetValues||!0===t.setValuesOnUpdate?h()(t.setValues):null,this.errors={},this.values=h()(t.setValues)}componentDidMount(){const{validateOnMount:t}=this.props;!0===t&&this.validateOnMount()}componentDidUpdate(){const{refValues:t}=this,{setValuesOnUpdate:e,setValues:s}=this.props;!0!==e||r()(t,s)||this.updateComponentValues()}submit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"submit"};const{checked:e,errors:s,values:i,touched:a}=this,{onSubmit:n}=this.props,o=n({event:t,...h()({...this.state,checked:e,errors:s,values:i,touched:a})});return v.isPromise(o)?o:{then:t=>t()}}validate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"validate"};const{checked:e,errors:s,values:i,touched:a}=this,{validate:n}=this.props,o=n({event:t,...h()({...this.state,checked:e,errors:s,values:i,touched:a})});return v.isPromise(o)?o:{then:t=>t(o)}}validateOnMount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"mount"};this.validateOnUpdate(t)}validateOnUpdate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"update"};this.setState({isUpdating:!0,isValidating:!0},(()=>this.validate(t).then((t=>{const e={...t&&t[0]||t||{}},s=!Object.values(e).filter((t=>!0===t)).length;this.errors=e,this.setState({isUpdating:!1,isValidating:!1,isValid:s})}))))}updateComponentValues(){const{setValues:t,setValuesAssumeBoolIsChecked:e,validateOnUpdate:s}=this.props;this.setState({isUpdating:!0},(()=>{this.checked=v.checkedSetValues(e,t),this.refValues=h()(t),this.values=h()(t),s?this.validateOnUpdate():this.setState({isUpdating:!1})}))}render(){const{checked:t,errors:e,values:s,touched:i}=this,{children:a}=this.props;return n().createElement(n().Fragment,null,a({handleOnEventCustom:this.onEventCustom,handleOnEvent:this.onEvent,handleOnReset:this.onReset,handleOnSubmit:this.onSubmit,...h()({...this.state,checked:t,errors:e,values:s,touched:i})}))}}v.propTypes={children:l().func.isRequired,onReset:l().func,onSubmit:l().func,resetUsingSetValues:l().bool,setValues:l().object,setValuesOnUpdate:l().bool,setValuesAssumeBoolIsChecked:l().bool,validate:l().func,validateOnMount:l().bool,validateOnUpdate:l().bool},v.defaultProps={onReset:c.Z.noop,onSubmit:c.Z.noop,resetUsingSetValues:!0,setValues:{},setValuesOnUpdate:!1,setValuesAssumeBoolIsChecked:!0,validate:c.Z.noop,validateOnMount:!1,validateOnUpdate:!1}}}]);
//# sourceMappingURL=../sourcemaps/384.3cfc39605872de75d39cf432603c4fcc.js.map