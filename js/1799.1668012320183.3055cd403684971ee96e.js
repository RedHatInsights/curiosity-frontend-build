"use strict";(self.webpackChunkcuriosity_frontend=self.webpackChunkcuriosity_frontend||[]).push([[1799],{91799:function(e,t,r){r.r(t),r.d(t,{GraphCardChart:function(){return C},default:function(){return C}});var a=r(1413),n=r(92950),o=r.n(n),l=r(21242),i=r(15451),u=r(51858),c=r(25394),d=r(78139),s=r(60930),p=r(64418),h=r(44024),v=r(99171),f=r(46262),y=r(91339),m=r(1797),g=r(83109),C=function(e){var t=e.t,r=e.useGetGraphTally,n=e.useGraphCardContext,u=e.useMetricsSelector,c=e.useProduct,g=e.useProductGraphTallyQuery,C=c().productId,T=n().settings,E=void 0===T?{}:T,G=E.actionDisplay,b=E.metric,P=E.metrics,x=void 0===P?[]:P,_=g()[f.O6.GRANULARITY],S=u(),D=S.pending,I=S.error,k=S.data,M=void 0===k?{}:k,L=S.dataSets,N=void 0===L?[]:L,A=r();(0,i.Z)((function(){A(x.map((function(e){var t=e.id;return{id:C,metric:t}})))}),[x,C,A]);var H=(null==b?void 0:b.id)&&"_".concat(null==b?void 0:b.id)||"",Q=null;return"function"==typeof G&&(Q=G({data:(0,a.Z)({},M)})),o().createElement(l.Card,{className:"curiosity-usage-graph"},o().createElement(y.MinHeight,{key:"headerMinHeight"},o().createElement(l.CardHeader,null,o().createElement(l.CardTitle,null,o().createElement(l.Title,{headingLevel:"h2",size:"lg"},t("curiosity-graph.cardHeading".concat(H),{context:C}),o().createElement(v.GraphCardChartTitleTooltip,null))),Q&&o().createElement(l.CardActions,{className:I?"blur":""},Q))),o().createElement(y.MinHeight,{key:"bodyMinHeight"},o().createElement(l.CardBody,null,o().createElement("div",{className:(I?"blur":D&&"fadein")||""},D&&o().createElement(m.Loader,{variant:"graph"}),!D&&o().createElement(s.Chart,Object.assign({},d.graphCardHelpers.generateExtendedChartSettings({settings:E,granularity:_}),{dataSets:N,chartLegend:function(e){var t=e.chart,r=e.datum;return o().createElement(p.GraphCardChartLegend,{chart:t,datum:r})},chartTooltip:function(e){var t=e.datum;return o().createElement(h.GraphCardChartTooltip,{datum:t})}}))))))};C.defaultProps={t:g.translate,useGetGraphTally:c.useGetGraphTally,useGraphCardContext:c.useGraphCardContext,useMetricsSelector:c.useMetricsSelector,useProduct:u.useProduct,useProductGraphTallyQuery:u.useProductGraphTallyQuery}},64418:function(e,t,r){r.r(t),r.d(t,{GraphCardChartLegend:function(){return p},default:function(){return p}});var a=r(92950),n=r.n(a),o=r(21242),l=r(89048),i=r(51858),u=r(61072),c=r(76006),d=r(83109),s=r(1138),p=function(e){var t=e.chart,r=e.datum,a=e.t,i=e.useDispatch,c=e.useSelectors,d=(0,e.useProduct)(),p=d.productLabel,h=d.viewId,v=i(),f=c(r.dataSets.map((function(e){var t=e.id;return function(e){var r;return null===(r=e.graph.legend)||void 0===r?void 0:r["".concat(h,"-").concat(t)]}})));(0,l.Z)((function(){r.dataSets.forEach((function(e,r){var a=e.id;((null==f?void 0:f[r])||t.isToggled(a))&&t.hide(a)}))}));var y=function(e){var r=t.toggle(e);v({type:u.JD.graph.SET_GRAPH_LEGEND,id:"".concat(h,"-").concat(e),value:r})};return n().createElement(n().Fragment,null,r.dataSets.map((function(e,r){var l=e.id,i=e.isThreshold,u=e.stroke,c=e.data,d=!(void 0===c?[]:c).find((function(e){var t=e.y,r=e.hasData;return t>=0&&!0===r||t>=0&&!0===i}))||!1,h=a(["curiosity-graph.label_".concat(i?"threshold":l),"curiosity-graph.label_no"],{product:p,context:p}),v=a("curiosity-graph.legendTooltip".concat(i?"_threshold":"","_").concat(l),{product:p,context:p},[n().createElement("span",{style:{whiteSpace:"nowrap"}})]),m=(null==f?void 0:f[r])||t.isToggled(l),g=n().createElement(o.Button,{onClick:function(){return y(l)},onKeyPress:function(){return y(l)},className:"curiosity-usage-graph__legend-item",tabIndex:0,key:"curiosity-button-".concat(l),variant:"link",component:"a",isDisabled:d,icon:(d||m)&&n().createElement(s.ChartIcon,{symbol:"eyeSlash"})||n().createElement(s.ChartIcon,{symbol:i?"dash":"square",style:{visibility:d||m?"hidden":"visible"},fill:u})},h);return v?n().createElement(o.Tooltip,{key:"curiosity-tooltip-".concat(l),content:n().createElement("p",null,v),position:o.TooltipPosition.top,enableFlip:!0,distance:5},g):g})))};p.defaultProps={chart:{hide:c.BM.noop,toggle:c.BM.noop,isToggled:c.BM.noop},datum:{dataSets:[]},t:d.translate,useDispatch:u.Cr.reactRedux.useDispatch,useSelectors:u.Cr.reactRedux.useSelectors,useProduct:i.useProduct}},99171:function(e,t,r){r.r(t),r.d(t,{GraphCardChartTitleTooltip:function(){return d},default:function(){return d}});var a=r(92950),n=r.n(a),o=r(21242),l=r(43551),i=r(51858),u=r(25394),c=r(83109),d=function(e){var t=e.t,r=e.useGraphCardContext,a=(0,e.useProduct)().productId,i=r().settings,u=void 0===i?{}:i,c=u.isCardTitleDescription,d=u.metric,s=(null==d?void 0:d.id)&&"_".concat(null==d?void 0:d.id)||"";return c?n().createElement(o.Tooltip,{content:n().createElement("p",null,t("curiosity-graph.cardHeadingDescription".concat(s),{context:a})),position:o.TooltipPosition.top,enableFlip:!1,distance:5,entryDelay:100,exitDelay:0},n().createElement("span",{className:"curiosity-icon__question"},n().createElement(l.OutlinedQuestionCircleIcon,null))):null};d.defaultProps={t:c.translate,useProduct:i.useProduct,useGraphCardContext:u.useGraphCardContext}},44024:function(e,t,r){r.r(t),r.d(t,{GraphCardChartTooltip:function(){return p},default:function(){return p}});var a=r(92950),n=r.n(a),o=r(51858),l=r(78139),i=r(83109),u=r(60930),c=r(1138),d=r(46262),s=r(76006),p=function(e){var t=e.datum,r=e.t,a=e.useProduct,o=e.useProductGraphTallyQuery,i=a(),p=i.productId,h=i.productLabel,v=o()[d.O6.GRANULARITY],f=null,y=[],m=(t||{}).itemsByKey,g=void 0===m?{}:m;return Object.keys(g).reverse().forEach((function(e,t){var a,o,i,d;0===t&&(f=(0,l.getTooltipDate)({date:null===(d=g[e])||void 0===d?void 0:d.data.date,granularity:v}));var s={color:null===(a=g[e])||void 0===a?void 0:a.color};if((null===(o=g[e])||void 0===o?void 0:o.chartType)===u.ChartTypeVariant.threshold){var m,C,T,E=null!==(m=null===(C=g[e])||void 0===C?void 0:C.data.y)&&void 0!==m?m:r("curiosity-graph.label_noData");null!==(T=g[e])&&void 0!==T&&T.data.hasInfinite&&(E=s.color?n().createElement(c.ChartIcon,{symbol:"infinity",fill:"#ffffff",title:r("curiosity-graph.label_threshold",{context:"infinite"})}):r("curiosity-graph.label_threshold",{context:"infinite"})),s.label=r("curiosity-graph.label_threshold"),s.value=E}else{var G,b,P=!1===(null===(G=g[e])||void 0===G?void 0:G.data.hasData)&&r("curiosity-graph.label_noData")||(null===(b=g[e])||void 0===b?void 0:b.data.y)||0;s.label=r("curiosity-graph.label_".concat(e),{context:p,product:h}),s.value=P}s.chartType=null===(i=g[e])||void 0===i?void 0:i.chartType,y.push(s)})),n().createElement("div",{className:"curiosity-usage-graph__tooltip"},n().createElement("table",{summary:r("curiosity-graph.tooltipSummary")},y.length&&f&&n().createElement("thead",null,n().createElement("tr",null,n().createElement("th",{colSpan:2},f)))||null,y.length&&n().createElement("tbody",null,y.map((function(e){var t,r,a="number"==typeof e.value&&!Number.isInteger(e.value)&&(null===(t=s.BM.numberDisplay(e.value))||void 0===t||null===(r=t.format({average:!0,mantissa:5,trimMantissa:!0,lowPrecision:!0}))||void 0===r?void 0:r.toUpperCase())||e.value;return n().createElement("tr",{key:"tooltip-".concat(e.label)},n().createElement("th",null,e.chartType===u.ChartTypeVariant.threshold&&n().createElement(c.ChartIcon,{size:"sm",symbol:"dash",fill:e.color||"transparent"}),e.chartType!==u.ChartTypeVariant.threshold&&n().createElement(c.ChartIcon,{size:"sm",fill:e.color||"transparent"})," ",e.label),n().createElement("td",null,a))})))||null),!y.length&&r("curiosity-graph.label_noData",{context:"error"})||null)};p.defaultProps={datum:{},t:i.translate,useProduct:o.useProduct,useProductGraphTallyQuery:o.useProductGraphTallyQuery}},25394:function(e,t,r){r.r(t),r.d(t,{DEFAULT_CONTEXT:function(){return u},GraphCardContext:function(){return c},context:function(){return h},default:function(){return h},useGetGraphTally:function(){return s},useGraphCardContext:function(){return d},useMetricsSelector:function(){return p}});var a=r(1413),n=r(92950),o=r.n(n),l=r(61072),i=r(51858),u=[{settings:{isStandalone:!1,metrics:[],metric:void 0}},r(62834).B.noop],c=o().createContext(u),d=function(){return(0,n.useContext)(c)},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.useDispatch,r=void 0===t?l.Cr.reactRedux.useDispatch:t,a=e.useProductGraphTallyQuery,n=void 0===a?i.useProductGraphTallyQuery:a,o=n(),u=r();return function(e){return l.Ak.rhsm.getGraphTally(e,o)(u)}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.useGraphCardContext,r=void 0===t?d:t,n=e.useSelectors,o=void 0===n?l.Cr.reactRedux.useSelectors:n,u=e.useProduct,c=void 0===u?i.useProduct:u,s=c(),p=s.productId,h=r(),v=h.settings,f=void 0===v?{}:v,y=f.metrics,m=void 0===y?[]:y,g={},C=o(m.map((function(e){var t=e.id;return function(e){var r;return null===(r=e.graph.tally)||void 0===r?void 0:r["".concat(p,"_").concat(t)]}})),[]),T=!1,E=!1,G=0,b=C.map((function(e,t){var r,n,o=e||{},l=o.pending,i=o.fulfilled,u=o.error,c=o.cancelled;!(!l&&!c)&&(T=!0),i&&(E=!0),u&&(G+=1);var d=(0,a.Z)((0,a.Z)({},m[t]),{},{data:(null==e||null===(r=e.data)||void 0===r?void 0:r.data)||[],meta:(null==e||null===(n=e.data)||void 0===n?void 0:n.meta)||{}});return g[m[t].id]=d,d})),P={data:g,dataSets:b,error:!1,fulfilled:!1,pending:!1};return G===b.length?P.error=!0:T?P.pending=!0:E&&(P.fulfilled=!0),P},h={GraphCardContext:c,DEFAULT_CONTEXT:u,useGetGraphTally:s,useGraphCardContext:d,useMetricsSelector:p}}}]);
//# sourceMappingURL=../sourcemaps/1799.js.map